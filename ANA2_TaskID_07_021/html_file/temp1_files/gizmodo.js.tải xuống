/*! automatically generated; DO NOT CHANGE : 17:36:10 GMT+0800 (CST) !*/
var _pop=_pop||[];var _popIn5_config={};(function(){var q=function(z,C){var B=z.container.querySelectorAll("._popIn_recommend_article"),A=document.createElement("a");A.className="_popIn_recommend_art_credit";A.href="https://www.popin.cc/discovery/what-is.php";A.target="_blank";A.textContent=C||"Recommended by popIn";for(var t=0,s=B.length;t<s;t++){B[t].appendChild(A.cloneNode(true))}};var g={};g["collect.pc"]="#_popIn_recommend {         display : none ;     }     ._popIn_recommend_container {         display : none ;     } ";g["standard.pc"]="div._popIn_infinite_page {         overflow : hidden ;     }     div._popIn_infinite_ad {         padding : 5px 0px ;         border-bottom : 1px solid #EEE ;         line-height : 1 ;         text-align : center ;         box-sizing : initial ;     }     div._popIn_infinite_empty {         display : none ;     }     ._popIn_recommend_container {         margin : 0 ;         padding : 0 ;         position : relative ;         background-color : white ;         font-family : inherit ;     }     ._popIn_recommend_header {         display : none ;     }     ._popIn_recommend_articles {         padding : 0 ;     }     ._popIn_infinite_page {     }     ._popIn_recommend_article {         display : inline-block ;         white-space : normal ;         width : 100% ;         position : relative ;         text-decoration : none ;         padding : 0 ;         border-bottom : none ;         margin : 0 0 1rem ;         box-sizing : border-box ;         overflow : hidden ;         clear : both ;         vertical-align : top ;     }     ._popIn_recommend_art_title {         text-align : left ;         font-size : 1.25rem ;         font-weight : bold ;         line-height : 1.5 ;         padding : 0px ;         margin : 0 0 8px ;         text-decoration : none ;         color : #333333 ;     }     ._popIn_recommend_art_title a {         font-size : inherit ;         line-height : inherit ;         font-weight : inherit ;         text-decoration : inherit ;         color : inherit ;     }     ._popIn_recommend_art_category {         display : none ;     }     ._popIn_recommend_art_date {         display : none ;     }     ._popIn_recommend_art_media {         margin : 0 ;         font-size : .8rem ;         font-weight : normal ;         line-height : normal ;         overflow : hidden ;         color : #9b9b9b ;         white-space : nowrap ;         max-width : 100% ;         text-overflow : ellipsis ;     }     ._popIn_recommend_art_credit {         font-size : .8rem ;         font-weight : 300 ;         line-height : normal ;         margin : 5px 0 ;         display : block ;     }     ._popIn_recommend_art_author {         display : none ;     }     ._popIn_recommend_art_img {         float : left ;         width : 40% ;         height : auto ;         position : relative ;         background : #f2f2f2 ;         margin : 0 15px 0 0 ;         transition : all 0.3s ;     }     ._popIn_recommend_art_img:hover {         opacity : 0.7 ;     }     ._popIn_recommend_art_img a {         margin : 0px ;         width : 100% ;         height : auto ;         padding-bottom : 57% ;         display : block ;         overflow : hidden ;         background-position : center ;         background-size : cover ;         opacity : 0 ;         transition  : opacity 500ms ;         -moz-transition  : opacity 500ms ;         -o-transition  : opacity 500ms ;         -webkit-transition  : opacity 500ms ;     }     ._popIn_recommend_no_img {         display : none ;     }     ._popIn_recommend_art_img a img {     }     ._popIn_recommend_credit {         display : none ;     }     ._popIn_recommend_credit_image {         display : inline-block ;         width : 40px ;         height : 10px ;         margin : 2px 0 0 3px ;         background-image : url(//api.popin.cc/images/logo.png) ;         background-repeat : no-repeat ;         background-position : 0px 0px ;         background-size : 40px 20px ;         vertical-align : text-top ;     }     ._popIn_infinite_video {         border-bottom : 1px solid #EEE ;     } ";g["standard_movie.mobile"]="#_popIn_video_container {         display : none ;     } ";g["collect.mobile"]="#_popIn_recommend {         display : none ;     }     ._popIn_recommend_container {         display : none ;     } ";g["standard.mobile"]="div._popIn_infinite_page {         overflow : hidden ;     }     div._popIn_infinite_ad {         padding : 5px 0px ;         border-bottom : 1px solid #EEE ;         line-height : 1 ;         text-align : center ;         box-sizing : initial ;     }     div._popIn_infinite_empty {         display : none ;     }     ._popIn_recommend_container {         margin : -26px 0 0 0 ;         padding : 0 ;         position : relative ;         background-color : white ;         border-top : 1px solid #dedede ;         font-family : inherit ;     }     ._popIn_recommend_header {         display : none ;     }     ._popIn_recommend_articles {         padding : 0 15px ;     }     ._popIn_infinite_page {     }     ._popIn_recommend_article {         display : inline-block ;         white-space : normal ;         width : 100% ;         position : relative ;         text-decoration : none ;         padding : 13px 0 ;         border-bottom : 1px solid #dedede ;         margin : 0 ;         box-sizing : border-box ;         overflow : hidden ;         clear : both ;         vertical-align : top ;     }     ._popIn_recommend_art_title {         text-align : left ;         font-size : .93333rem ;         max-height : calc(.93333rem * 1.5 * 2) ;         display : -webkit-box ;         -webkit-box-orient : vertical ;         -webkit-line-clamp : 2 ;         font-weight : bold ;         line-height : 1.5 ;         padding : 0px ;         margin : 0 0 5px ;         text-decoration : none ;         overflow : hidden ;         color : #333333 ;     }     ._popIn_recommend_art_title a {         font-size : inherit ;         line-height : inherit ;         font-weight : inherit ;         text-decoration : inherit ;         color : inherit ;     }     ._popIn_recommend_art_category {         display : none ;     }     ._popIn_recommend_art_date {         display : none ;     }     ._popIn_recommend_art_media {         margin : 0 ;         font-size : .8rem ;         font-weight : normal ;         line-height : normal ;         overflow : hidden ;         color : #AAA ;         white-space : nowrap ;         max-width : 100% ;         text-overflow : ellipsis ;     }     ._popIn_recommend_art_credit {         font-size : .8rem ;         line-height : normal ;         margin : 3px 0 0 0 ;         display : block ;     }     ._popIn_recommend_art_author {         display : none ;     }     ._popIn_recommend_art_img {         float : left ;         width : 85px ;         height : auto ;         position : relative ;         background : #f2f2f2 ;         margin : 0 15px 10px 0 ;     }     ._popIn_recommend_art_img a {         margin : 0px ;         width : 100% ;         height : auto ;         padding-bottom : 72% ;         display : block ;         overflow : hidden ;         background-position : center ;         background-size : cover ;         opacity : 0 ;         transition  : opacity 500ms ;         -moz-transition  : opacity 500ms ;         -o-transition  : opacity 500ms ;         -webkit-transition  : opacity 500ms ;     }     ._popIn_recommend_no_img {         display : none ;     }     ._popIn_recommend_art_img a img {     }     ._popIn_recommend_credit {         display : none ;     }     ._popIn_recommend_credit_image {         display : inline-block ;         width : 40px ;         height : 10px ;         margin : 2px 0 0 3px ;         background-image : url(//api.popin.cc/images/logo.png) ;         background-repeat : no-repeat ;         background-position : 0px 0px ;         background-size : 40px 20px ;         vertical-align : text-top ;     }     ._popIn_infinite_video {         border-bottom : 1px solid #EEE ;     } ";var h={};h["default"]=["pattern",["left","ad",2],["rand","ad_reserved",2],["rand","e_ranking",50],["rand","related",10],["rand","hot","pop","recommend",50],[["related_img","pop_img","hot_img","recommend_img"],["ad","e_ranking","pop_img","related_img","recommend_img"],["ad","recommend_img","hot_img","pop_img","related_img"],["ad_reserved","related_img","pop_img","hot_img","recommend_img"],["e_ranking","pop_img","hot_img","recommend_img"],["ad","hot_img","pop_img","related_img","recommend_img"],["ad","related_img","hot_img","pop_img","related_img"],["ad","e_ranking","hot_img","recommend_img","related_img"]]];var e={};if(typeof e.all==="undefined"){e.all={}}e.all["Read"]={mainNode:".p-post-content",readArticle:true};if(typeof e.pc==="undefined"){e.pc={}}e.pc["Discovery"]={adVideo:location.href.indexOf("popinvideotest=")>-1?true:false,adEnable:true,load:"fast",agency:"popinag",templates:[{credit:"Recommended by",selector:"#_popIn_recommend",position:"AfterBegin",title:"",css:g["collect.pc"],type:["rand","related",0]},{abtestName:"",channelId:"standard",dateFormat:"(Y年M月D日)",delWord:"",delImage:"",mediaFormat:"Sponsored $MEDIA",plugins:["Imageback"],afterRender:q,css:g["standard.pc"],imageInView:true,imageSize:"160",position:"AfterBegin",selector:"#_popIn_recommend",credit:"Recommended by",title:"関連記事",infiniteSize:2,infinitePages:1,type:["rand","ad",4]}],apiUrlAdd:"&r_category=all",apiUrl:location.protocol+"//jp.popin.cc/popin_discovery/recommend?mode=new&url=%target"};if(typeof e["mobile-test"]==="undefined"){e["mobile-test"]={}}e["mobile-test"]["Discovery"]={adVideo:location.href.indexOf("popinvideotest=")>-1?true:false,adEnable:true,load:"fast",agency:"popinag",templates:[{abtestName:"",channelId:"standard",adVideoPosition:1,dateFormat:"(Y年M月D日)",delWord:"",delImage:"",afterRender:function(i){},css:g["standard_movie.mobile"],imageSize:"160",imageInView:true,infiniteSize:1,infinitePages:1,plugins:["clickall","Infinite"],position:"AfterBegin",selector:"#_popIn_video",credit:"Recommended by",title:"今、あなたにオススメ",type:["rand",["left","hot","pop","related","recommend",1],1],mediaFormat:"PR（$MEDIA）",useCfRatio:0,containerId:"_popIn_video_container",adVideoInsertSelector:"#_popIn_video",adVideoInsertPosition:"AfterBegin"}],apiUrlAdd:"&r_category=all",apiUrl:location.protocol+"//jp.popin.cc/popin_discovery/recommend?mode=new&url=%target"};if(typeof e.mobile==="undefined"){e.mobile={}}e.mobile["Discovery"]={adVideo:location.href.indexOf("popinvideotest=")>-1?true:false,adEnable:true,load:"fast",agency:"popinag",templates:[{credit:"Recommended by",selector:"#_popIn_recommend",position:"AfterBegin",title:"",adVideoPosition:0,css:g["collect.mobile"],type:["rand","related",0]},{abtestName:"",channelId:"standard",adVideoPosition:1,dateFormat:"(Y年M月D日)",delWord:"",delImage:"",afterRender:q,css:g["standard.mobile"],imageSize:"160",imageInView:true,infiniteSize:2,infinitePages:1,plugins:["clickall","infinite"],position:"AfterBegin",selector:"#_popIn_recommend",credit:"Recommended by",title:"関連記事",type:["rand","ad",4],mediaFormat:"Sponsored $MEDIA",useCfRatio:0}],apiUrlAdd:"&r_category=all",apiUrl:location.protocol+"//jp.popin.cc/popin_discovery/recommend?mode=new&url=%target"};var x="https://ciatr.jp/topics/307680";var l=["mobile-test","pc-test"];var k="jp.popin.cc";var o=window.location.protocol.indexOf("http")>-1?"https:":window.location.protocol;for(var v=0;v<l.length;++v){var m=l[v];if(typeof e[m]==="undefined"||typeof e[m].Discovery==="undefined"){continue}e[m].Discovery.apiUrl=o+"//"+k+"/popin_discovery/recommend?mode=new&url="+encodeURIComponent(x)+"&topn=50&agency=popinag"}var p={pid:"gizmodo",urlReplace:[{"[?#].*":""}],contextSelector:"main"};var f=1;f+=(location.href.indexOf("popinlib6=true")>-1?1:0);if(f>0){(function(B,E){if(void 0===E[B]){E[B]=function(){E[B].clients.push(this),this._init=[Array.prototype.slice.call(arguments)]},E[B].clients=[];for(var D=function(i){return function(){return this["_"+i]=this["_"+i]||[],this["_"+i].push(Array.prototype.slice.call(arguments)),this}},C=["addRecord","set","trackEvent","trackPageview","trackClicks","ready"],z=0;z<C.length;z++){var G=C[z];E[B].prototype[G]=D(G)}var F=document.createElement("script");F.type="text/javascript",F.async=!0,F.src=("https:"===document.location.protocol?"https:":"http:")+"//api.popin.cc/td_js_sdk_171.js";var A=document.getElementsByTagName("script")[0];A.parentNode.insertBefore(F,A)}})("Treasure2",window);(function(){try{if(typeof window.PopIn6!=="undefined"){return}var ae=(typeof window._popIn_ad_block_enable!=="undefined"&&window._popIn_ad_block_enable)?"i.popincdn.com":"api.popin.cc";var I={common:p};window.PopIn6={uid:"",_tempLog:[],log:function(az){this._tempLog.push(az)},event:{},protocol:(/^https:/.test(window.location.protocol)===true)?"https:":"http:",domain:ae,handleError:at};window.popInGlobal=window.popInGlobal||{};if(typeof Array.prototype.forEach==="undefined"){return}if((typeof window.performance!=="undefined")&&(typeof window.performance.getEntries==="function")){PopIn6.__PERFORMANCE_DISCOVERY_INIT__=window.performance.now()}if(typeof Object.assign!="function"){(function(){Object.assign=function(aD){if(aD===undefined||aD===null){throw new TypeError("Cannot convert undefined or null to object")}var aA=Object(aD);for(var aB=1;aB<arguments.length;aB++){var aC=arguments[aB];if(aC!==undefined&&aC!==null){for(var az in aC){if(Object.prototype.hasOwnProperty.call(aC,az)){aA[az]=aC[az]}}}}return aA}})()}var am=new Treasure2({writeKey:"8378/25839e06ce4cc1cab55c1c1f1e49d336d6d1d48f",database:"popin_ads"});am.set("$global","td_global_id","td_global_id");am.ready(function(){am.trackValues=am.getTrackValues()});window.PopIn6._logger=am;ak(PopIn6.event);I._utils={ce:aa,cio:E,inView:i,setPopInDomData:L,getPopInDomData:aw};function aa(aA,az,aD,aC){var aB=aA.appendChild(document.createElement(az));if(aD){aB.setAttribute("class",aD)}if(aC){aB.appendChild(document.createTextNode(aC))}return aB}function E(az,aB){az=az||"about:self";aB=aB||{};var aC=(typeof aB.pnode!=="undefined"&&typeof aB.pnode.nodeValue!=="undefined")?aB.pnode:document.body;var aA=aa(aC,"iframe");aA.src=az;aA.setAttribute("scrolling","no");aA.setAttribute("frameBorder","0");aA.setAttribute("allowTransparency","true");(function(aE){aE.display="block";aE.width="0px";aE.height="0px";aE.margin="0px";aE.padding="0px";aE.overflow="none"})(aA.style);var aD={element:aA,document:aA.contentDocument||aA.contentWindow.document,window:(aA.contentWindow)?aA.contentWindow:(aA.contentDocument.document)?aA.contentDocument.document:aA.contentDocument,write:function(aE){aD.document.open();aD.document.write(aE);aD.document.close()}};return aD}function D(az){var aA=az.getBoundingClientRect();return aA.top>0&&window.innerHeight-aA.top>0}var ah={valid:true};try{[["local",window.localStorage],["session",window.sessionStorage]].forEach(function(aA){var az={};var aB=aA[1];ah[aA[0]]=az;ah.valid=ah.valid&&!!aB.getItem;az.get=function(aC){return aB.getItem(aC)};az.set=function(aC,aD){aB.setItem(aC,aD)};az.remove=function(aC){aB.removeItem(aC)}})}catch(au){ah.valid=false}function i(){if("function"===typeof window.IntersectionObserver){C.apply(this,arguments)}else{z.apply(this,arguments)}}var T=[];var O=false;function z(aA,aB){var az=function(){if(D(aA)){aB();return true}return false};if(!az()){T.push(az)}if(A(T)&&O===false){O=setInterval(function(){if(T.length>0){for(var aD=T.length;aD--;){var aC=T[aD]();if(aC){T.splice(aD,1)}}}if(T.length===0){clearInterval(O);O=false}},100)}}var ay;var P={};var al=0;function C(aA,aB){if(!ay){ay=new IntersectionObserver(function(aC){aC.forEach(function(aF){if(aF.isIntersecting){var aD=aF.target.__popIn_inview_handler_key__;var aE=P[aD];"function"===typeof aE&&aE();delete P[aD];delete aF.target.__popIn_inview_handler_key__;ay.unobserve(aF.target)}})},{rootMargin:"0px"})}var az=""+al++;aA.__popIn_inview_handler_key__=az;P[az]=aB;ay.observe(aA)}function A(az){return typeof az!=="undefined"&&az!==""&&az!==0&&az!==false&&az!==null}function J(aB,aA){if(!A(aB)||!A(aA)){return aB}var az=aB;aA.forEach(function(aD){var aC=Object.keys(aD);aC.forEach(function(aE){az=az.replace(new RegExp(aE),aD[aE])})});return az}var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!$";function aj(aD){var aC=0,aF="",aB="";for(var aA=0,aE=aD.length;aA<aE;aA++){aB=aD.charCodeAt(aA);aC=((aC<<5)-aC)+aB;aC|=0}for(var az=0;az<6;az++){aF+=s.charAt(aC&63);aC>>>=6}return aF}function ai(aC){var aB=aC.length,aA,az;while(0!==aB){az=Math.floor(Math.random()*aB);aB-=1;aA=aC[aB];aC[aB]=aC[az];aC[az]=aA}return aC}function K(az,aC){var aD="_p6_"+(Date.now()*100+Math.round(Math.random()*100)).toString(16);window[aD]=function(aE){try{aC(aE);delete window[aD]}catch(aF){at(aF)}};var aB=document.createElement("script");aB.type="text/javascript";aB.charset="utf-8";aB.async=true;aB.src=az+"&callback="+aD;var aA=document.getElementsByTagName("script")[0];aA.parentNode.insertBefore(aB,aA)}function Q(){var az=navigator.userAgent;return[/(tablet|ipad|playbook|silk)|(?!.*android.?_).*(?=android(?!.*mobile))/i].some(function(aA){return(az.match(aA))})?"tablet":[/Android/i,/webOS/i,/iPhone/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(function(aA){return(az.match(aA))})?"mobile":"pc"}function H(){var az=window.navigator.userAgent;switch(true){case /Android/.test(az):return"Android";case /iPhone|iPad|iPod/.test(az):return"iOS";case /Windows/.test(az):return"Windows";case /Mac OS X/.test(az):return"Mac"}return"other"}function ao(aA,az){try{return ap(aA.split(az)[1].trim().split(/[^\w\.]/)[0])}catch(aB){}return"0.0.0"}function ap(az){var aA=az.split(/[\._]/);return(parseInt(aA[0],10)||0)+"."+(parseInt(aA[1],10)||0)+"."+(parseInt(aA[2],10)||0)}function ab(az,aA){switch(aA){case"Android":return ao(az,"Android");case"iOS":return ao(az,/OS /);case"Windows":return ao(az,/Phone/.test(az)?/Windows Phone (?:OS )?/:/Windows NT/);case"Mac":return ao(az,/Mac OS X /)}return"0.0.0"}function U(az){switch(true){case /CriOS/.test(az):return"Chrome for iOS";case /Edge/.test(az):return"Edge";case /Chrome/.test(az):return"Chrome";case /Firefox/.test(az):return"Firefox";case /Android/.test(az):return"AOSP";case /MSIE|Trident/.test(az):return"IE";case /Safari\//.test(az):return"Safari";case /AppleWebKit/.test(az):return"WebKit";case /Vivaldi/.test(az):return"Vivaldi"}return""}function af(aA,az){switch(az){case"Chrome for iOS":return ao(aA,"CriOS/");case"Edge":return ao(aA,"Edge/");case"Chrome":return ao(aA,"Chrome/");case"Firefox":return ao(aA,"Firefox/");case"Vivaldi":return ao(aA,"Vivaldi/");case"AOSP":return ao(aA,/Silk/.test(aA)?"Silk/":"Version/");case"IE":return/IEMobile/.test(aA)?ao(aA,"IEMobile/"):/MSIE/.test(aA)?ao(aA,"MSIE "):ao(aA,"rv:");case"Safari":return ao(aA,"Version/");case"Webkit":return ao(aA,"WebKit/")}return""}function aq(){var az=window.screen;return az?[az.width,az.height].join("x"):"-"}function V(){var aB=document.documentElement&&document.documentElement.clientHeight;var aE=document.documentElement&&document.documentElement.clientWidth;var aD=window.innerHeight;var aA=window.innerWidth;var az=aB<aD?aD:aB;var aC=aE<aA?aA:aE;return aC+"x"+az}function G(){var aD=window.navigator;var aA=aD.userAgent;var aC=H(aA);var aE=ab(aA,aC);var az=U(aA);var aB=af(aA,az);return{os:aC,os_version:aE,browser:az,browser_version:aB,screen:aq(),viewport:V(),user_agent:window.navigator.userAgent,referrer:document.referrer,path:location.pathname,charset:(document.characterSet||document.charset||"-").toLowerCase(),language:aD&&(aD.language||(aD.language||aD.browserLanguage)||"-").toLowerCase(),color:window.screen?window.screen.colorDepth+"-bit":"-",title:document.title,url:document.location.href.split("#")[0],platform:window.navigator.platform,host:document.location.host}}var ax=G();function N(aB){var aC=aB.split(".");var az=[];for(var aA=aC.pop();aC.length>0;aA=aC.pop()){if(aA==="www"){break}az.push(aA);if(aA.length>3&&az.length>0){break}}return az.reverse().join(".")}function ad(az){var aA={};if(az.indexOf("?")>0){qString=az.substring(az.indexOf("?"));az=az.substring(0,az.indexOf("?"));qString.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(aC,aB,aE,aD){aA[aB]=aD})}return{url:az,qString:aA}}function ag(aB){var aA=/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/;var az=aB.match(aA);if(az){return{scheme:az[1],host:az[2],path:az[3],query:az[4],fragment:az[5]}}else{return null}}function ak(az){az._listeners={};az.addEventListener=function(aA,aB){if(!this._listeners[aA]){this._listeners[aA]=[]}this._listeners[aA].push(aB)};az.fireEvent=function(aC,aB){var aA=this;var aD=aA._listeners[aC];if(!Array.isArray(aB)){aB=[aB]}aB.push(I);if(A(aD)){aD.forEach(function(aE){aE.apply(aA,aB)})}};az.addEventListenerFromEventMap=function(aE){if(!aE){return}var aD;for(var aB in aE){if(!aE.hasOwnProperty(aB)){continue}aD=aE[aB];if(!Array.isArray(aD)){aD=[aD]}for(var aA=0,aC;aC=aD[aA];aA++){"function"===typeof aC&&az.addEventListener(aB,aC)}}};window.PopInGlobal=window.PopInGlobal||{};az.addEventListenerFromEventMap(p.customEvents);az.addEventListenerFromEventMap(window.PopInGlobal.customEvents)}function t(aB){var aA=[];aA.push('<body style="margin:0px;padding:0px;background-color: transparent;">');aA.push("<script>window.inDapIF = true;<\/script>");aA.push(aB);aA.push("</body>");var az=E("about:self");az.write(aA.join(""))}function at(aE){if(!window.Treasure2){setTimeout(function(){at.apply(this,arguments)},500);return}var aB=new window.Treasure2({writeKey:"8378/25839e06ce4cc1cab55c1c1f1e49d336d6d1d48f",database:"fe_monitor"});var aA=av||{};var az=Z||{};var aF={msg:aE.message||"",stack:aE.stack||"",name:aE.name||"",ua:navigator.userAgent,api_host:aA.apiHost||"",device:Q(),media:aA.media||"",url:aA.target||"",logid:az.logid||"",piuid:W?W.getUid():""};var aD=PopIn6._logger.trackValues||{};for(var aC in aD){aF[aC]=aD[aC]}aB.addRecord("err_log",aF);throw aE}window.PopIn6.handleError=at;var ar=[];var ac="__popIn_dom_key__";function aw(aC,aA){if(!aC){return{}}var az=+aC[ac];if("number"!==typeof az||az===NaN){return null}var aB=ar[az]||null;return"string"===typeof aA?aB[aA]:aB}function L(aD,aA,aC){if(!aD){return null}var az=aD[ac]||"";var aB={};if(az===""){az=ar.length;aD[ac]=az}else{az=+az;aB=ar[az]||{}}if(typeof aA==="string"){aB[aA]=aC}else{if(Object.prototype.toString.call(aA)==="[object Object]"){aB=Object.assign(aB,aA)}}ar[az]=aB;return aB}var M={};M.Class=function(aB,aA,aC){var az=this[aB]=function(){if(this.init){this.init.apply(this,arguments)}};az.prototype=aA;if(aC&&Object.prototype.toString.call(aC)==="[object Object]"){Object.assign(az,aC)}};I.Discovery6=M;M.Class("ArticleItem",{init:function(aK,aH){for(var aC in aK){this[aC]=aK[aC]}var aA="";var aG="";var aJ=window.PopIn6.protocol;var aF=aH.imageSize;var aB=aH.notFoundImg;var aL="";this.ad=aK.type.indexOf("ad")===0;this.reserved=aK.type.indexOf("reserved")>0;if(this.ad){var az=["api_host="+av.apiHost,"piuid="+W.getUid()];if(A(Z.logid)){az.push("logid="+Z.logid)}var aE=[];if(A(aH.channelId)){aE.push("m_ch_"+aH.channelId)}if(A(Z.channel)&&Array.isArray(Z.channel)){aE.push.apply(aE,Z.channel.map(function(aM){return"m_"+aM}))}if(aE.length>0){az.push("extra="+aE.join("%7C"))}this.url+=((/\?/.test(this.url)===true)?"&":"?")+az.join("&");aG=aK.image;if(A(aF)&&(""+aF).indexOf("w")===0){aA=aJ+"//f.popincdn.com/"+aF+"/";aL=aA+aG}else{aA=aJ;aL=aG.indexOf("http://images.popin.cc")>0?aA+aG.replace(/http:\/\/images.popin.cc/,"//i.popincdn.com"):aG;if(aA==="https:"&&aL.indexOf("http://images.popin.cc")>-1){aL=aL.replace(/http:\/\/images.popin.cc/,"https://i.popincdn.com")}}aL=aL.replace(/i.popincdn.com/,"imageaws.popin.cc");this._setTrackingPixelConfig(aK);if(aK.imp){this.originalImp=aK.imp;this.imp=aK.imp+((/\?/.test(aK.imp)===true)?"&":"?")+az.join("&")}if(aK.dsp){var aI=new M.Dsp(aK.dsp);if(aI.setup(this,{addParameters:az})){this.dspObj=aI}}}else{if(A(aF)&&(""+aF).indexOf("w")===0){aG=aK.image_url||"";aA=aJ+"//f.popincdn.com/"+aF+"/";aL=aA+aG}else{if(A(aF)&&(""+aF)==="original"){aG=aK.image_url||"";aL=aG}else{aG=aK.image||"";if(aG==="noimage"||!A(aG)){aG=""}else{aA=aG.indexOf("http")>-1?"":"https://i.popincdn.com/article/";aL=aA+((aF===""||aG.indexOf("http")>-1)?aG:aG.replace(".","_"+aF+"."))}}}aL=aL.replace(/i.popincdn.com/,"imageaws.popin.cc")}this.image=A(aG)?aL:aB;var aD=ad(this.url);this.token=aD.qString.token;this.uid=aD.qString.uid},_formatTrackingPixelMacroCode:function(aF,aC){var aE=aF;var az={"{{p_advid}}":aC.userid,"{{p_campId}}":aC.campaign,"{{p_sid}}":av.media,"{{p_adid}}":aC.nid};for(var aA in az){var aB=new RegExp(aA,"g"),aD=az[aA];aE=aE.replace(aB,aD)}return aE},_setTrackingPixelConfig:function(aB){if(A(aB.click_tracking_pixel)){this.click_tracking_pixel=this._formatTrackingPixelMacroCode(aB.click_tracking_pixel,aB)}if(A(aB.tracking_pixel)){this.tracking_pixel=this._formatTrackingPixelMacroCode(aB.tracking_pixel,aB);var az=this._getCustomTrackingPixelConf(this.tracking_pixel);if(az){if(az.name==="ias"){var aC="&ias_adpath=%23",aA=/((https?:)?\/\/\w+\.adsafeprotected.com\/(?!.*ias_adpath.*)([\w-./?%&=]*)?)/g,aD,aE;aD=aB.campaign+aB.nid+new Date().getTime();aE=btoa(aj(aD));this.trackingPixelConf={};this.trackingPixelConf.name=az.name;this.trackingPixelConf.trackingNodeId=aE;this.tracking_pixel=this.tracking_pixel.replace(aA,"$1"+aC+aE)}}}},_getCustomTrackingPixelConf:function(aD){var aC=[{name:"ias",check_reg:/https?:\/\/\w+.adsafeprotected.com\//}],aB;for(var aA=0,az=aC.length;aA<az;aA++){aB=aC[aA];if(aB.check_reg&&aB.check_reg.test(aD)){return aB}}}});M.Class("ArticleRenderer",{init:function(az,aB,aA){this.article=aB;this.articleDiv=az;this.template=aA;this.ad=aB.type.indexOf("ad")===0;this.render(A(aA.channelId)?aA.channelId:false)},render:function(aD){var aP=this.article,az=this.articleDiv,aN=this.template;az.classList.add("_popIn_recommend_article_"+aP.type);if(aN.isFullClick){az.setAttribute("href",aP.url)}if(aP.type2.indexOf("_noimg")>-1){az.classList.add("_popIn_recommend_no_img")}else{az.classList.add("_popIn_recommend_has_img")}if(aP.trackingPixelConf&&aP.trackingPixelConf.trackingNodeId){az.id=aP.trackingPixelConf.trackingNodeId}var aL=aa(az,"div","_popIn_recommend_art_img");var aC=aa(aL,"a");aC.href=aP.url;aC.style.opacity=1;var aM=function(){aC.style.backgroundImage="url("+aP.image+")"};if(aN.imageInView){i(aC,aM)}else{aM()}var aA=aa(az,"div","_popIn_recommend_art_title");var aK=aa(aA,"a",false,aP.title);aK.href=aP.url;var aG=aa(az,"div","_popIn_recommend_art_category",aP.category);if(aP.media){var aI=aa(az,"div","_popIn_recommend_art_media",aN.mediaFormat.replace("$MEDIA",aP.media))}var aJ=aa(az,"div","_popIn_recommend_art_date",aP.formattedDate);if(aP.author_name){var aF=aa(az,"div","_popIn_recommend_art_author",aP.author_name)}var aB=Array.apply(null,az.querySelectorAll("a")),aO=(aN.isTargetTop===true)?"_top":(aN.addTargetBlank===true)?"_blank":null;if(az.nodeName==="A"){aB.push(az)}for(var aE=0,aH=aB.length;aE<aH;aE++){this._editLinkNode(aB[aE],aD,aO)}},_editLinkNode:function(az,aA,aB){if(this.ad){this._editAdLinkNode(az,aB)}if(aB!==null){az.target=aB}az.addEventListener("click",this._onClick.bind(this,aA),false)},_editAdLinkNode:function(aA,aB){aA.href=this._replacePopInFlagInAdLink(aA.href);aA.target=(aB===null)?"_blank":aB;aA.setAttribute("rel","nofollow");var az="&mode=20170420&referer_type="+B;if(typeof PopIn6._logger.trackValues!=="undefined"){az+="&td_client_id="+PopIn6._logger.trackValues.td_client_id}aA.href+=az},_replacePopInFlagInAdLink:function(aA){if(aA.indexOf("popIn_flag_")===-1){return aA}var az={"${popIn_flag_media_host}":location.host,"${popIn_flag_os}":H(),"${popIn_flag_timestamp}":X};return aA.replace(/\blp=.+?&/,function(aC){for(var aB in az){aC=aC.replace(new RegExp(encodeURIComponent(aB),"g"),az[aB])}return aC})},_onClick:function(aD,aC){var aE=aC.currentTarget;aC.preventDefault();aC.stopPropagation();var aA=this.article,az=(aE.target==="_blank"),aB=aE.href;if(/^ad/.test(aA.type)===true){this._onClickAd(aB,aA,aD,az)}else{this._onClickArticle(aB,aA,aD,az)}},_writeArticleClickHistory:function(aA){if(ah.valid===false){return}var aD="_popIn_article_click_history";var aC=ah.local,aB=aC.get(aD),aE=(aB===null)?[]:JSON.parse(aB),az=aE.filter(this._isNotSameHistoryURL.bind(this,aA));az.push({url:aA,timestamp:Date.now()});aC.set(aD,JSON.stringify(az))},_isNotSameHistoryURL:function(az,aA){return(aA.url!==az)},_onClickArticle:function(aB,aA,aD,az){var aC=aA.type;ah.valid&&ah.session.set("_pi_article_recommend_type",aC);this._writeArticleClickHistory(aB);var aE;if(az){this._openNewTab(aB)}else{aE=this._movePage.bind(null,aB)}M.Log.articleClickLog(aA,aE,{channelId:aD});if(typeof aE==="function"){setTimeout(aE,200)}},_onClickAd:function(aB,aA,aC,az){M.Log.adClickLog(aA,{channelId:aC});if(A(aA.click_tracking_pixel)){t(aA.click_tracking_pixel)}if(aA.dspObj){aA.dspObj.execDspFunc("click",aA)}if(az){this._openNewTab(aB)}else{this._movePage(aB)}},_movePage:function(az){window.top.location.href=az},_openNewTab:function(az){window.open(az,"_blank")}});M.Class("ArticleStyleMonitor",{styleFlagEnum:{UNKNOW:"0",ERROR:"_",STYLE_1:"1",STYLE_2:"2",STYLE_3:"3",STYLE_4:"4",STYLE_5:"5",STYLE_6:"6"},checkList:["checkStyle1","checkStyle2","checkStyle3","checkStyle4","checkStyle5","checkStyle6"],init:function(az){this.articleNode=az;this.styleFlag=""},initAttribute:function(){this.articleRect=this.articleNode.getBoundingClientRect();this.parentNode=this.articleNode.parentNode;this.parentRect=this.parentNode.getBoundingClientRect();this.imageNode=this.articleNode.querySelector("._popIn_recommend_art_img");this.imageRect=this.imageNode.getBoundingClientRect();var az=this.articleNode.querySelector("._popIn_recommend_art_title");this.titleNode=az.children[0]||az;this.titleRect=this.titleNode.getBoundingClientRect()},getStyleFlag:function(){try{if(this.styleFlag){return this.styleFlag}this.initAttribute();var az;for(var aB=0,aA;aA=this.checkList[aB++];){if("function"!==typeof this[aA]){continue}az=this[aA]();if(az){return(this.styleFlag=az)}}}catch(aC){return(this.styleFlag=this.styleFlagEnum.ERROR)}return(this.styleFlag=this.styleFlagEnum.UNKNOW)},checkStyle1:function(){if(this.imageRect.width===0&&this.imageRect.height===0){return this.styleFlagEnum.STYLE_1}},checkStyle2:function(){if(this.titleRect.top>=this.imageRect.bottom&&(this.articleRect.width/this.parentRect.width)>=0.9){return this.styleFlagEnum.STYLE_2}},checkStyle3:function(){if(this.titleRect.top>=this.imageRect.bottom){return this.styleFlagEnum.STYLE_3}},checkStyle4:function(){if(this.imageRect.right<=this.titleRect.left){return this.styleFlagEnum.STYLE_4}},checkStyle5:function(){if(this.titleRect.right<=this.imageRect.left){return this.styleFlagEnum.STYLE_5}},checkStyle6:function(){if(this.titleRect.top>this.imageRect.top&&this.titleRect.right>this.imageRect.left&&this.titleRect.bottom<=this.imageRect.bottom&&this.titleRect.left<this.imageRect.right){return this.styleFlagEnum.STYLE_6}}});var an=[];M.Class("ArticlesSelector",{init:function(aA){this.template=aA;this.type=aA.type;this.useCf=false;this.includeRules=[].concat(aA.includeRules);this.excludeRules=[].concat(aA.excludeRules);if(aA.isClickHistory){this.processCookie(Z.cookie)}if(aA.hideHistory===true){var az=ah.local.get("_popIn_article_click_history");this._articleClickHistories=az===null?[]:JSON.parse(az);this._articleExpiredTime=Date.now()-(aA.articleNoDisplayPeriod*(24*60*60*1000));this.excludeRules.push(this._canShowArticle.bind(this))}},_canShowArticle:function(az){if(/^ad/.test(az.type)===true){return true}return this._articleClickHistories.every(this._isValidPeriodArticle.bind(this,az.url,this._articleExpiredTime))},_isValidPeriodArticle:function(aA,az,aB){return(this._isInvalidPeriodArticle(aA,az,aB)===false)},_isInvalidPeriodArticle:function(aA,az,aB){return(aB.url===aA)&&(aB.timestamp>=az)},getData:function(){this.isCfRatio();var az=this.process(this.type);var aA=this.template.infiniteSize*this.template.infinitePages;return A(az)?az.slice(0,Math.min(aA,az.length)):[]},isCfRatio:function(){var aE=this.template.useCfRatio||p.useCfRatio;if(!aE){return}var az=ah.valid&&ah.session.get("_pi_cf_abtest_key_"+this.template.channelId);if(az){this.useCf="with_cf"===az?true:false}else{if(Math.random()<=+aE){ah.session.set("_pi_cf_abtest_key_"+this.template.channelId,"with_cf");this.useCf=true}else{ah.session.set("_pi_cf_abtest_key_"+this.template.channelId,"without_cf")}}if(this.useCf){var aD=this.type;var aG=false;for(var aC=0,aB=aD.length;aC<aB;aC++){var aA=aD[aC];var aF="";if(typeof aA=="string"){aF="+"+aA+"+"}if(Array.isArray(aA)){aF="+"+aA.join("+")+"+"}if(/\+cf\+/.test(aF)){aG=true;break}}if(!aG){this.type.splice(1,0,["left","cf",50])}}},deleteDuplicates:function(aD){var aB={};var aA=[];function az(aI){for(var aG=0;aG<aI.length;aG++){var aH=aG+"_"+aI[aG];if(aB[aH]){return false}else{aB[aH]=1}}return true}an.forEach(az);for(var aC=0;aC<aD.length;aC++){var aF=aD[aC];var aE=az(aF.hashData);if(aE){aA.push(aF)}}return aA},processArticle:function(aA,az){var aB=az.indexOf("ad")>-1;if(A(aA.title)&&A(this.template.delWord)&&!aB){aA.title=aA.title.replace(new RegExp(this.template.delWord,"g"),"")}if(A(aA.title)){aA.title=aA.title.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,"&")}if(!A(aA.title)){return false}if(aA.url===av.target){return false}if(aA.pureUrl===void 0){aA.pureUrl=aA.url}if(!aB){aA.url=A(this.template.displayUrlReplace)?J(aA.url,this.template.displayUrlReplace):aA.url;aA.url+=(A(this.template.addQuery)?(((/[?]/.test(aA.url))?"&":"?")+this.template.addQuery):"")}aA.originalUrl=aA.url.indexOf("?url=")>0?decodeURIComponent(ad(aA.url).qString.url):aA.url;if((this.template.delImage&&aA.image.indexOf(this.template.delImage)>=0)||(aA.image==="noimage")){aA.image=""}aA.type=az;aA.type2=az+(aA.image?"_img":"_noimg");aA.hashData=[aj(aA.title),aj(aA.originalUrl)];aA.formattedDate=(A(aA.pubdate)&&aA.pubdate!=="000000000000000000")?this.formatDate(aA.pubdate):"";if(!this.isValid(aA)){return false}return aA},formatDate:function(aA){var az=this.template.dateFormat;if(aA.slice(8,12)==="0000"&&/h|m|s/.test(az)){az=az.replace(/h|m|s|:|：|\s|時|分|秒/g,"")}var aB={Y:[0,4],M:[4,6],D:[6,8],h:[8,10],m:[10,12],s:[12,14]};Object.keys(aB).forEach(function(aD){var aC=Number(String.prototype.slice.apply(aA,aB[aD]));if(/m|s/.test(aD)&&aC<10){aC="0"+aC}az=az.replace(new RegExp(aD),aC)});return az},isValid:function(aC){for(var aB=0,aF=this.excludeRules.length;aB<aF;aB++){var aE=this.excludeRules[aB];if(!aE(aC)){return false}}for(var aA=0,az=this.includeRules.length;aA<az;aA++){var aD=this.includeRules[aA];if(aD(aC)){return true}}return true},getArticlesByType:function(aC){var aB=Z[aC];var az=[];for(var aA=0;aA<aB.length;aA++){var aE=Object.assign({},aB[aA]);var aD=this.processArticle(aE,aC);if(aD){az.push(aD)}}return az},process:function(az){if(typeof az==="string"&&Z[az]){return this.template.forceProcess?this.deleteDuplicatesDsp(this.getArticlesByType(az)):this.deleteDuplicates(this.getArticlesByType(az))}if(Array.isArray(az)){var aA=az[0];if(typeof this[aA]==="function"){return this.template.forceProcess?this.deleteDuplicatesDsp(this[aA](az)):this.deleteDuplicates(this[aA](az))}}return[]},getMiddle:function(aB){var aA=[];for(var az=1;az<aB.length-1;az++){aA=aA.concat(this.process(aB[az]))}return aA},rand:function(aB){var az=aB[aB.length-1];var aA=ai(this.getMiddle(aB));return aA.slice(0,Math.min(az,aA.length))},left:function(aB){var az=aB[aB.length-1];var aA=this.getMiddle(aB);return aA.slice(0,Math.min(az,aA.length))},right:function(aB){var az=aB[aB.length-1];var aA=this.getMiddle(aB);return aA.slice(Math.max(0,aA.length-az),aA.length).reverse()},pattern:function(aA){var aE=aA[aA.length-1];var aB=this.getMiddle(aA);var aP=[];var aO=[].concat(aB);var aD=true;while(aD){aD=false;var aC=aE;while(typeof aC==="function"){aC=aC()}if(aC.length>0&&this.useCf){for(var aM=0,aG=aC.length;aM<aG;aM++){var aJ=aC[aM];if(Array.isArray(aJ)){if(aJ[0]=="ad"||/^ad_/.test(aJ[0])){aC[aM].splice(1,0,"cf_img")}else{if(aJ[0]!="cf_img"){aC[aM].splice(0,0,"cf_img")}}}else{if(aJ=="ad"||/^ad_/.test(aJ)){aC.splice(aM,1,[aJ,"cf_img"])}else{if(aJ!="cf_img"){aC.splice(aM,1,["cf_img",aJ])}}}}}for(var aM=0,az=aC.length;aM<az;aM++){var aI=aC[aM];aI=Array.isArray(aI)?aI:[aI];loop:for(var aL=0,aH=aI.length;aL<aH;aL++){var aF=aI[aL];for(var aK=0,aN=aO.length;aK<aN;aK++){var aQ=aO[aK];if(aQ.type2.search(aF)>-1){aD=true;aP.push(aQ);aO.splice(aK,1);break loop}}}}}return aP},processCookie:function(aA){var aC=aA._click;if(!A(aC)){return}var aB={};var aD=aC.split("|");var az=Date.now();aD.forEach(function(aE){var aF=aE.split(".");var aH=aF[1];var aG=(az-aF[2])/(24*60*60*1000);if(aG>30){return}if(typeof aB[aH]==="undefined"){aB[aH]=0}aB[aH]++});this.addExcludeRuleForAd(aB)},addExcludeRuleForAd:function(az){this.excludeRules.push(function(aA){var aC=aA.type.indexOf("ad")>-1;if((aC&&!aA.dsp)&A(az[aA.nid])){var aB=az[aA.nid];if(aB>=3){return false}}return true})},deleteDuplicatesDsp:function(aD){var aB={};var aA=[];function az(aH){for(var aF=0;aF<aH.length;aF++){var aG=aF+"_"+aH[aF];if(aB[aG]){return false}else{aB[aG]=1}}return true}an.forEach(az);for(var aC=0;aC<aD.length;aC++){var aE=aD[aC];if(aE.type==="ad"&&aE.dsp){if(!az(aE.hashData)){continue}}aA.push(aE)}return aA}});M.Class("Box",{init:function(aN){var aI=this;this.timeoutId=false;this._canSendChannelImpLog=true;if(!aN.selector&&!(aN.selector=document.querySelector(aN.selectorStr))){if(aI.timeoutId){clearTimeout(aI.timeoutId)}aI.timeoutId=setTimeout(function(){aI.init(aN)},200);return}var aC=new M.ArticlesSelector(aN);var aH=aC.getData();if(aH.length>0){var aJ=aH.length%aN.infiniteSize;if(aJ!==0){aH=aH.slice(0,aH.length-aJ)}aH.forEach(function(aO){an.push(aO.hashData)});this.data=aH}if(aH.length<aN.infiniteSize){return}var aK=false;for(var aF=0,aL=aH.length;aF<aL;aF++){var aE=aH[aF];if(aE.type=="cf"){aK=true;break}}this.template=aN;var aB=aN.cfChannelPrefix||p.cfChannelPrefix||"";var aD=A(aN.channelId)?aN.channelId:false;if(aK&&aD&&aD.indexOf("with_sz_")!==0){aD=aB+aD}this.channelId=aD;aN.channelId=aD;if(av.adEnable){M.Log.adRequestLog()}M.Log.previewLog();M.Log.concatenationPVLog();this.renderBox();M.Performance.addTimeMark("box_did_render").addMark("is_box_rendered",true).report();i(this.container,function(){M.Log.boxInViewLog({channelId:aD,isFeedModule:aN.isFeedModule});if(aD){M.Log.boxInViewLogs({channelId:aD,isFeedModule:aN.isFeedModule,boxPosition:this.boxPosition.getPosition()});M.Log.intextBoxInViewLog({channelId:aD})}}.bind(this));if(aD){M.Log.intextBoxRenderedLog({channelId:aD,isFeedModule:aN.isFeedModule})}if(A(Z.common_category)){(function aA(aO,aQ){try{if(aQ<0){return}var aP=PopIn5.$.Context.findContext(aO);aP.segmentData.commonCategory=Z.common_category;aP.segmentData.mainCategory=encodeURIComponent(Z.category)}catch(aR){setTimeout(function(){aA(aO,--aQ)},200)}})(this.container,20)}if(PopIn6.infinite.isEnable&&!PopIn6.infinite.isStart){PopIn6.infinite.isStart=true;PopIn6.event.fireEvent("infinite-loading",[])}var az=0;var aM=function(){if(typeof PopIn5!=="undefined"&&A(PopIn5.$)&&A(PopIn5.$.Config)){PopIn5.$.Config.apiHost=av.apiHost;clearInterval(aG)}if(az>10){clearInterval(aG)}az++};var aG=setInterval(aM,500)},renderBox:function(){var aJ=aa(this.template.selector,"div","_popIn_recommend_container");if(A(this.template.containerId)){aJ.setAttribute("id",this.template.containerId)}this.container=aJ;this.boxPosition=new M.BoxPosition(this.container);this.adPosition=0;var aN=aa(aJ,"div","_popIn_recommend_header",this.template.title);var aF=aa(aJ,"div","_popIn_recommend_articles");this.boxStyleMonitor=new M.BoxStyleMonitor(aJ);var aA=this.data;var aB=aF;var aS=this.template.infiniteSize;var aL=this.template.infinitePages;var aE=this.template.channelId;var aH=this.template.isFeedModule;var aC=ah.valid?ah.session.get("_pi_article_recommend_type"):"";for(var aO=0,aQ=aA.length;aO<aQ;aO++){var aR=Math.floor(aO/aS);var aD=aO%aS;if(aR>=aL){break}if(aD===0){aB=aa(aF,"div","_popIn_infinite_page")}var aI=new M.ArticleItem(aA[aO],this.template);aI.renderPosition=aO+1;aI.channelId=aE;aI.isFeedModule=aH;aI.referrerRecommendType=aC||"";var az=this.template.isFullClick?"a":"div";var aP=aa(aB,az,"_popIn_recommend_article _popIn_idx"+(aD+1));var aM=new M.ArticleRenderer(aP,aI,this.template);var aK=new M.ArticleStyleMonitor(aP);aI.element=aP;aI.articleStyleMonitor=aK;var aG=null;if(aM.ad===true){aG=this._onImpForAd;if(this.adPosition===0){this.positionAndStyle=new M.PositionAndStyle({channelId:aE,boxPosition:this.boxPosition,articleStyleMonitor:aK})}}else{aG=this._onImpForArticle}aI.adPosition=(aM.ad===true)?++this.adPosition:undefined;aI.boxStyleMonitor=this.boxStyleMonitor;L(aP,Object.assign({},aI));if(aI.trackingPixelConf&&aI.trackingPixelConf.trackingNodeId){t(aI.tracking_pixel);aI.tracking_pixel=undefined}i(aP,aG.bind(this,aI))}new M.BoxFooter(aJ,this.template);if(typeof this.template.afterRender==="function"){this.template.afterRender(this)}PopIn6.event.fireEvent("after-render",this);new M.Video(aJ,this.template);if(this.template.canInfiniteAds){new M.InfiniteAds(aJ,this.template)}},_onImpForArticle:function(az){var aA=this.channelId;M.Log.articleInViewLog(az,{channelId:aA});PopIn6.event.fireEvent("article-imp",az)},_onImpForAd:function(az){M.Log.adBoxRenderedLog(az);var aA=this.channelId;if(aA){M.Log.adBoxRenderedLogs(az,{channelId:aA})}if(aA&&(this._canSendChannelImpLog===true)){M.Log.intextBoxImpLog({channelId:aA});this._canSendChannelImpLog=false}PopIn6.event.fireEvent("article-imp",az);if(A(az.debug)){return}var aB=Math.round((Date.now()-X)/1000);if(aB>60*30){return}setTimeout(function(){if(az.imp){var aC=new Image();aC.src=az.imp}M.Log.adInViewLog(az,{channelId:aA,boxPosition:this.boxPosition.getPosition()});if(az.dspObj){az.dspObj.execDspFunc("imp",az)}}.bind(this),1000)}});M.Class("BoxFooter",{init:function(az,aA){this.template=aA;if(aA.credit){var aB=aa(az,((this.template.aboutPageType==="sameTab")?"a":"div"),"_popIn_recommend_credit",aA.credit);aa(aB,"div","_popIn_recommend_credit_image");aB.addEventListener("click",this._onClick.bind(this))}},_onClick:function(){switch(this.template.aboutPageType){case"dialogue":this.showCredit();break;case"newTab":window.open("https://www.popin.cc/discovery/what-is.php");break}},close:function(){if(A(this.black)){document.body.removeChild(this.black);this.black=false}},showCredit:function(){var az=this;var aD=function(){az.close()};var aE=aa(document.body,"div");aE.id="_popIn_about_black";(function(aF){aF.position="fixed";aF.width="100%";aF.height="100%";aF.left="0px";aF.top="0px";aF.backgroundColor="rgba(0, 0, 0, 0.75)";aF.zIndex=9998})(aE.style);this.black=aE;aE.addEventListener("click",aD);var aB=aa(aE,"div");aB.id="_popIn_about_inner";(function(aF){aF.position="absolute";aF.width="500px";aF.height="450px";aF.left="50%";aF.top="50%";aF.marginLeft="-250px";aF.marginTop="-225px";aF.backgroundColor="white";aF.borderRadius="6px";aF.zIndex=9999})(aB.style);var aA=aa(aB,"div");(function(aF){aF.position="absolute";aF.top="-18px";aF.left="-18px";aF.background="url(https://"+ae+"/images/close.png) no-repeat";aF.width="36px";aF.height="36px";aF.cursor="pointer"})(aA.style);aA.addEventListener("click",aD);var aC=aa(aB,"iframe");aC.src="https://www.popin.cc/discovery/what-is.php";aC.frameBorder="0";aC.scrolling="no";(function(aF){aF.width="480px";aF.height="430px";aF.border="0px";aF.margin="10px 0px 0px 10px"})(aC.style)}});M.Class("BoxPosition",{init:function(az){this.box=az;this.position=""},getPosition:function(){if(this.position){return this.position}if(window.self!==window.top){this.position="iframe"}else{this.position=Q()==="mobile"?this.getPositionInMobile():this.getPositionInPc()}return this.position},getElementAbPosition:function(aB){var aA=aB.offsetLeft;var az=aB.offsetTop;while(aB=aB.offsetParent){aA+=aB.offsetLeft;az+=aB.offsetTop}return{left:aA,top:az}},getPositionInMobile:function(){var az=this.box.getBoundingClientRect();var aA=this.getElementAbPosition(this.box);var aC=aA.top+az.height/2;var aB=document.documentElement.scrollHeight;if(!aB||!aC){return"unknow"}else{if(aC<(aB/3)){return"top"}else{if(aC<(aB/3*2)){return"middle"}else{return"bottom"}}}},getPositionInPc:function(){var aA=this.box.getBoundingClientRect();var aC=this.getElementAbPosition(this.box);var aE=aC.top+aA.height/2;var aB=aC.left+aA.width/2;var aD=document.documentElement.scrollHeight;var az=document.documentElement.scrollWidth;if(!aD||!az||!aE){return"unknow"}return[(aE<(aD/2))?"top":"bottom",(aB<(az/2))?"left":"right"].join("_")}});M.Class("BoxStyleMonitor",{init:function(az){this.boxNode=az;this.styleFlag=""},getStyleFlag:function(){if(this.styleFlag){return this.styleFlag}var aC=this.boxNode.querySelectorAll("._popIn_infinite_page:first-child ._popIn_recommend_article");var aB="";for(var aA=0,az;az=aC[aA];aA++){var aD=aw(az,"articleStyleMonitor");if(!aD){aB+="_";continue}aB+=aD.getStyleFlag()}return(this.styleFlag=aB)}});M.Class("BrandSafety",{init:function(){this.impIdArry=[]},process:function(aA,az){az=az||{};if(!az.logid){return false}this.logid=az.logid||"";this.media=az.media||location.host;this.apiHost=az.apihost||"jp.popiin.cc";this.impIdArry[this.logid]=(typeof this.impIdArry[this.logid]!=="undefined")?this.impIdArry[this.logid]+1:1;this._momentumTagRender(aA)},_momentumTagRender:function(aB){var aE="jp.popin.cc";if(aE!==this.apiHost){return}var aF=38,aA="UUID_DIV",aG=this.logid,az=this.impIdArry[this.logid],aC=this.media,aH=document.createElement("script");aH.src="//assets-momentum.akamaized.net/js/axss.js";aB.classList.add(aA);var aD=function(){momentum_heron.set_postbid_observer(aA,aF,aG,String(az),aC,{dest:"http://jp.popin.cc/popin_discovery/pbc",payload:{ext:{momentum:{heron:{require:[1,2,4]}}}}})};if(typeof aH.onload!=="undefined"){aH.onload=aD}else{if(aH.readyState){aH.onreadystatechange=aD}}document.body.appendChild(aH)}});M.Class("Config",{init:function(aD){aD=aD||{};this.setDefaults(aD);var aA=this.findConfig(e);if(!aA){return}for(var aC in aA){this[aC]=aA[aC]}for(var az in p){this[az]=p[az]}var aB=[];if(A(aA.templates)){aA.templates.forEach(function(aE){aB.push(new M.Template(aE))})}this.templates=aB;this.positionAndStyleObj=M.PositionAndStyle.getPositionAndStyle();this.afterConfig()},setDefaults:function(az){this.device=(Q()!=="mobile")?"pc":"mobile";this.target=typeof az!=="undefined"?az.target||location.href:location.href;this.media=location.host;this.agency="popinag";this.topn=50;this.pathnum=null;this.ad=10;this.country=false;this.apiUrl=window.PopIn6.protocol+"//discoveryplus.popin.cc/popin_discovery/recommend?";this.isArticle=true;this.segmentData={};this.apiUrlAdd="";this.defaultUseSzAdLtrRadio=0.5;this.defaultUseSzAdLtr=false;this.defaultUseSzAdLtrChannelIdPrefix="with_sz_"},afterConfig:function(){var az=this;this.target=J(this.target,this.urlReplace);var aC=[];aC.push("device="+this.device);aC.push("media="+this.media);aC.push("extra="+H().toLowerCase());aC.push("agency="+this.agency);aC.push("topn="+this.topn);var aA=[[A(this.cfid),"cfid="+this.cfid],[A(this.adEnable),"ad="+this.ad],[A(this.pathnum),"pathnum="+this.pathnum],[A(this.apiUrlAdd),this.apiUrlAdd.replace(/^&/,"")],[!A(this.isArticle),"related=false"],[true,"piuid="+W.getUid()],[A(PopIn6.smjId),"smjid="+PopIn6.smjId]];aA.forEach(function(aD){if(aD[0]){aC.push(aD[1])}});this.apiUrl=this.apiUrl.replace("%target",encodeURIComponent(this.target)+"&");if(this.apiUrl.indexOf("url=")===-1){aC.push("url="+encodeURIComponent(this.target))}this.apiUrl+=(this.apiUrl.indexOf("?")>-1?(this.apiUrl.slice(-1)!=="?"?"&":""):"?")+aC.join("&");var aB=location.href.match(/popincampaign=([^&]+)/);if(aB){this.apiUrl+="&popindemo="+aB[1]}this.apiUrl+="&info="+this.createInfoData();this.apiHost=ag(this.apiUrl).host.replace("discoveryplus.","jp.");this.setSzAdLtrByBatch()},createInfoData:function(){var aA=this.getUserTdInfo();aA.user_device=this.device;aA.user_time=X;aA.fruit_box_position=this.positionAndStyleObj.boxPosition;aA.fruit_style=this.positionAndStyleObj.adStyleMonitor;var az=location.href.match(/popin_sid_sample=([^&]+)/);if(az){aA.sid_sample=az[1]}PopIn6.event.fireEvent("after-create-info-data",aA);return btoa(unescape(encodeURIComponent(JSON.stringify(aA))))},findConfig:function(aC){var aB=(Q()!=="mobile")?"pc":"mobile";var aA=A(R)?[aB+"-test",aB,"all-test","all"]:[aB,"all"];for(var az=0;az<aA.length;az++){var aD=aA[az];if(aC[aD]&&aC[aD].Discovery){return aC[aD].Discovery}}return false},getUserTdInfo:function(){if(!this.userTdData){var aB=ax;var aA={};for(var az in aB){aA["user_td_"+az]=az=="title"?encodeURIComponent(aB[az]):aB[az]}this.userTdData=aA}return this.userTdData},sortModuleByDom:function(aH){var aD=[];var az=[];var aB=[];for(var aC=0,aG=aH.length;aC<aG;aC++){if(!aH[aC].selector){az.push(aH[aC]);continue}aD.push(aH[aC]);if(aH[aC].selectorStr){aB.push(aH[aC].selectorStr)}}var aA=document.querySelectorAll(aB.join(","));var aE=Array.prototype.slice.call(aA,0);for(var aC=0,aG=aD.length-1;aC<aG;aC++){var aF=aD[aC];for(j=0,jl=aD.length-1-aC;j<jl;j++){if(aE.indexOf(aD[j].selector)>aE.indexOf(aD[j+1].selector)){var aI=aD[j];aD[j]=aD[j+1];aD[j+1]=aI}}}return aD.concat(az)},setSzAdLtrByBatch:function(){if((this.apiHost!=="tw.popin.cc"&&this.apiHost!=="jp.popin.cc")||"ignore"===this.useSzAdLtrRadio||this.apiUrl.indexOf("&alg=ltr")!==-1||this.apiUrlAdd.indexOf("&alg=ltr")!==-1){return}var az=typeof this.useSzAdLtrRadio==="number"?this.useSzAdLtrRadio:this.defaultUseSzAdLtrRadio;if(Math.random()<=az){this.apiUrl=this.apiUrl+"&alg=ltr";this.appenedAdLtrPrefix()}},appenedAdLtrPrefix:function(){var aB="";if(this.useSzAdLtrChannelIdPrefix===undefined){aB=this.apiHost==="tw.popin.cc"?"witd_sz_":this.defaultUseSzAdLtrChannelIdPrefix}else{aB=this.useSzAdLtrChannelIdPrefix}for(var az=0;az<this.templates.length;az++){var aA=this.templates[az];if(aA.channelId&&aA.channelId.indexOf("with_sz_")!==0){aA.channelId=aB+aA.channelId}}}});M.Class("Criteo",{init:function(az,aA){this.createProxy(az,aA);this.aspectArticleRendererAd();this.aspectDiscoveryLog()},createProxy:function(aC,aE){var aG=function(){aE(aC)};var aB=av.criteoZoneId||"1097335";var aA=av.criteoCampaignId||"5a1407ff211463e92a72d121";var aD=av.criteoNId||"5a140913211463152b72d121";var aF=window.PopIn6.protocol+"//cas.criteo.com/delivery/0.1/napi.jsonp?zoneid="+aB;var az=this;K(aF,function(aH){if(A(aH)&&aH.response_status===0||R){return az.setArticleFromProduct(aC,aH,aE,aB,aA,aD)}aG()})},setArticleFromProduct:function(aK,aE,aC,aB,aH,az){if(R&&aE.response_status!==0){aE={};aE.products=[{title:"Red shoes",description:"Male running shoes",price:"$ 120",click_url:"http://cat.criteo.com/delivery/ck.php",image:{url:"http://images.popin.cc/discovery/667d8c9b2cdfec7b74b19c8d8f9355f7.png",width:160,height:160}},{title:"Blue shoes",description:"Male running shoes.",price:"$ 120",click_url:"http://cat.criteo.com/delivery/ck.php?debug=true",image:{url:"http://images.popin.cc/discovery/667d8c9b2cdfec7b74b19c8d8f9355f7.png",width:160,height:160}}];aE.privacy={optout_click_url:"http://info.criteo.com/pac/privacy/informations",optout_image_url:"http://static.criteo.net/flash/icon/nai_small.png"};aE.advertiser={logo:{url:"http://images.eu.criteo.net/img/img?c=1&l=1&h=70&w=70",width:70,height:70},logo_click_url:"http://cat.criteo.com/delivery/ck.php",description:"Advertiser",domain:"advertiser.com"};aE.impression_pixels=[{url:"http://cat.criteo.com/delivery/lg.php"},{url:"http://www.advertiser.com/impression.gif"}]}aK.ad_criteo=[];var aA=Math.min(aE.products.length,aK.ad.length);for(var aD=0;aD<aA;aD++){var aI=aE.products[aD];var aJ={};var aG=aK.ad[aD].url;aJ.criteo=aE;aJ.criteoProduct=aI;aJ.title=aI.title;aJ.image=aI.image.url;aJ.nid=az;aJ.campaign=aH;var aF="https://a.popin.cc/popin_redirect/redirect?url={{url}}&nid={{nid}}&campaign={{campaign}}&media={{media}}&device={{device}}&category=criteo&t={{time}}&token={{token}}&uid={{uid}}&nc=1";aF=aF.replace(/{{url}}/,encodeURIComponent(aI.click_url));aF=aF.replace(/{{nid}}/,az);aF=aF.replace(/{{campaign}}/,aH);aF=aF.replace(/{{media}}/,av.media);aF=aF.replace(/{{device}}/,av.device);aF=aF.replace(/{{time}}/,Date.now());aF=aF.replace(/{{token}}/,Math.random().toString().replace(/\./,""));aF=aF.replace(/{{uid}}/,aG.match(/uid=(.+)/)[1]);aJ.url=aF;aJ.userid=aE.advertiser.description;aJ.domain=aE.advertiser.domain;aK.ad_criteo.push(aJ)}return aC(aK)},aspectArticleRendererAd:function(){var aA=M.ArticleRenderer.prototype;var az=aA.render;aA.render=function(){if(A(this.article.criteo)){this.article.media=this.article.criteo.advertiser.domain}az.apply(this,[])};var aB=aA.addLinkEvent;aA.addLinkEvent=function(){aB.apply(this,[]);if(A(this.article.criteo)){var aF=this.article;var aG=function(aH){if(aH.classList.contains("_popIn_3rdparty")){aH.href=aF.criteo.privacy.optout_click_url;return}};var aD=Array.prototype.slice.call(this.articleDiv.querySelectorAll("A"));var aE=this.template;var aC=this.ad;if(aE.isFullClick){if(!aC){aD=[this.articleDiv]}else{aD.push(this.articleDiv)}}aD.forEach(function(aH){aG(aH)})}}},aspectDiscoveryLog:function(){var az=M.Log.adInViewLog;var aA=M.Log.adRequestLog;var aB=function(aF){var aD=aF.impression_pixels;if(!A(aD)){return}for(var aE=0;aE<aD.length;aE++){var aC=aD[aE];var aG=new Image();aG.src=aC.url}aB=function(){}};M.Log.adInViewLog=function(aD){var aC=A(aD.criteo)?{common_category:"criteo"}:{};if(A(aD.criteo)){az.apply(this,[aD,aC]);M.Log.adCriteoInViewLog(aD,aC);aB(aD.criteo)}else{az.apply(this,[aD,aC])}};M.Log.adRequestLog=function(){aA.apply(this,[]);M.Log.adCriteoRequestLog()}}});M.Class("CSSManager",{init:function(){this.cache=[];this.css=""},add:function(aA){var aB=aj(aA);var az=this.cache.some(function(aC){return aB===aC});if(!az){this.css+=aA;this.cache.push(aB)}},render:function(){var az=document.createElement("style");az.type="text/css";az.rel="stylesheet";az.charSet="UTF-8";document.getElementsByTagName("head")[0].appendChild(az);az.appendChild(document.createTextNode(this.css))}});M.Class("Dsp",{init:function(az){this._dspName=az||"";this._dspObj={}},setup:function(aA,aB){var az="Dsp"+this._dspName.charAt(0).toUpperCase()+this._dspName.slice(1);if(M[az]){this._dspObj=new M[az](aA,aB)}else{return false}return true},execDspFunc:function(aB,az){var aA="_"+aB;if(this._dspObj[aA]){this._dspObj[aA](az)}}});M.Class("DspLogicad",{init:function(az,aA){this.item=az;this.parameter=aA||{}},_sendImgRequest:function(aA){var az=new Image();az.src=aA},_imp:function(az){if(this.item.nurl){this._sendImgRequest(this.item.nurl)}if(Array.isArray(this.item.imptrackers)){this.item.imptrackers.forEach(function(aA){this._sendImgRequest(aA)},this)}},_click:function(){if(Array.isArray(this.item.clicktrackers)){this.item.clicktrackers.forEach(function(az){this._sendImgRequest(az)},this)}}});M.Class("InfiniteAds",{init:function(az,aA){if(Q()!=="mobile"){return}this.container=az;this.template=aA;if(typeof PopIn6.infiniteCounter==="undefined"){PopIn6.infiniteCounter=0}this.ic=A(av.infiniteSerializeEnable)?PopIn6.infiniteCounter:0;this.slots=this.getSlots();this.ads=this.getAds();if(A(this.slots)&&A(this.ads)){this.renderAds()}},getSlots:function(){var az=this.container.querySelectorAll("._popIn_infinite_page");var aB=[];for(var aA=0,aD=az.length;aA<aD;aA++){var aC=az[aA];if(A(aC.querySelector("._popIn_infinite_video"))){continue}aB.push(aC)}return aB},getAds:function(){var az=[].concat(A(Z.infinite)?Z.infinite:[]);return az},renderAds:function(){var az=this.ic;for(var aA=0,aD=this.slots.length;aA<aD;aA++){var aC=this.slots[aA];var aB=this.ads[az%this.ads.length];if(A(aB)&&aB.type==="ad"){this.renderOneAd(aC,aB)}az++}PopIn6.infiniteCounter=az},renderOneAd:function(aF,aA){var aE=aa(document.createDocumentFragment(),"div","_popIn_infinite_ad");aE.style.height=aA.height+"px";var aD=(this.template.infiniteAdInsertPosition||"beforeend").toLowerCase();switch(aD){case"beforebegin":aF.parentNode.insertBefore(aE,aF);break;case"afterbegin":aF.insertBefore(aE,aF.firstChild);break;case"beforeend":aF.appendChild(aE);break;case"afterend":aF.parentNode.insertBefore(aE,aF.nextSibling);break}var aB=[];aB.push('<body style="margin:0px;padding:0px;background-color: transparent;">');aB.push("<script>window.inDapIF = true;<\/script>");aB.push(aA.script);aB.push("</body>");var az=E("about:self",{pnode:aE});(function(aG){aG.width=aA.width+"px";aG.height=aA.height+"px";aG.margin="0px auto"})(az.element.style);var aC=function(){az.write(aB.join(""))};if(A(av.adInView)){i(aE,aC)}else{aC()}}});M.Class("Loader",{init:function(){function aD(aF){var aJ=aF.ad;var aI=aF.ad_smj;if(!aJ||av.isShowSmjAd===false||!Array.isArray(aI)||aI.length===0){return}if(aJ.length===0){aF.ad=aI;return}var aK={};var aH=0;var aL=[];var aG;while(aG=aI[aH++]){aK[aG.nid]=1;aG.url+="&smjad=1";aG.isSmjAd=true;aL.push(aG)}aH=0;while(aG=aJ[aH++]){if(!aK[aG.nid]){aL.push(aG)}}aF.ad=aL}var aA=function(aG){Z=aG;window.popInGlobal=window.popInGlobal||{};window.popInGlobal.common_category=aG.common_category;if(aG.article_read){window.popInGlobal.articleReadLogForRT={articleId:aG.article_read}}PopIn6.event.fireEvent("result-loaded",[aG]);if(!A(PopIn6.uid)&&A(aG)){var aI=function(aN){if(ah.valid&&A(aN)){ah.session.set("_ss_pp_id",aN);ah.local.set("_ss_pp_id",aN)}};var aK=Z.cookie;if(A(aK)&&A(aK.uid)){PopIn6.uid=aK.uid;aI(aK.uid)}else{var aH=E("https://api.popin.cc/retarget/uid.html?ac=getuid");var aM=aH.window;window.addEventListener("message",function(aN){if(aM===aN.source){aI(aN.data)}},false)}}if(!A(av.templates)){return}var aF=new M.CSSManager();var aL=av.templates.filter(function(aN){var aO=aN.type.slice(-1)[0];if(typeof aO==="number"&&aO===0){return false}aF.add(aN.css);return true});aF.render();aD(Z);var aJ=new M.BrandSafety();aL.forEach(function(aN){var aO=new M.Box(aN);if(aO.container){aJ.process(aO.container,{logid:Z.logid,media:av.media,apihost:av.apiHost})}});if(aL.length===0){PopIn6.event.fireEvent("no-content",[])}else{PopIn6.event.fireEvent("start-render",[])}if(av.isArticle){M.Log.relatedLog();M.Log.snsLog()}PopIn6.event.fireEvent("cehck-update",[Z]);return};if(window.context&&(window.context.tagName==="AMP-AD")){this._editTemplatesForAMP(av.templates);PopIn6.event.addEventListener("start-render",function(){setTimeout(function(){var aH=document.getElementById("_popIn_amp_recommend");var aG=aH.offsetWidth+"px";var aF=aH.offsetHeight+"px";window.context.renderStart({width:aG,height:aF})},1)});PopIn6.event.addEventListener("no-content",function(){window.context.noContentAvailable()});window.context.onResizeDenied(function(aG,aF){setTimeout(function(){window.context.requestResize(aF,aG)},500)})}var aC=function(){M.Performance.addTimeMark("api_will_request");var aI=av.thirdParty;var aF=false;if(A(aI)){var aG=function(aK,aJ,aL){return aK.indexOf("criteo")>-1};aF=aI.some(aG)}if(aF){var aH=aA;aA=function(aJ){new M.Criteo(aJ,aH)}}PopIn6.event.fireEvent("before-loaded",[av]);K(av.apiUrl,function(aJ){if(R>0){window._popIn_discovery_test={result:aJ,callback:aA};var aL=document.createElement("script");aL.type="text/javascript";aL.charset="UTF-8";aL.async=true;aL.src="https://i.popincdn.com/test/discovery_test6.js";var aK=document.getElementsByTagName("script")[0];aK.parentNode.insertBefore(aL,aK);return}else{M.Performance.addTimeMark("api_data_will_deal");aA(aJ)}})};aC();if(A(av.templates)){var aB=av.templates.some(function(aF){return A(aF.selectorStr)&&aF.selectorStr==="._popIn_recommend"});PopIn6.infinite={};PopIn6.infinite.isEnable=aB;PopIn6.infinite.isStart=false;if(aB){var aE=[];if(document.querySelector("._popIn_recommend")){aE.push(document.querySelector("._popIn_recommend"))}var az=function(){var aF=function(aO,aL){var aN=false;for(var aM=0,aP=aL.length;aM<aP;aM++){if(aO===aL[aM]){aN=true;break}}return aN};var aG=function(aN){var aL=aN.getAttribute("data-url");av.templates.forEach(function(aO){if(A(aO.selector)&&aO.selectorStr==="._popIn_recommend"){aO.selector=aN}});av.setDefaults();var aM=av.findConfig(e);if(aM){av.apiUrl=aM.apiUrl}av.target=aL;av.afterConfig();aC()};var aH=document.querySelectorAll("._popIn_recommend");for(var aI=0,aK=aH.length;aI<aK;aI++){var aJ=aH[aI];if(!aF(aJ,aE)){aE.push(aJ);aG(aJ)}}};PopIn6.event.addEventListener("infinite-loading",function(aF){setInterval(az,500)},false)}}},_editTemplatesForAMP:function(aB){if(!aB){return}var aC;for(var aA=0,az=aB.length;aA<az;aA++){aC=aB[aA];if(typeof aC==="object"){aC.isTargetTop=true;aC.aboutPageType="sameTab"}}}});M.Log={loggers:{},_addLogger:function(az,aA){this.loggers[az]=aA;for(var aB in aA){if(aB.indexOf("_")===0){continue}this._addLogFunction(aB)}},_addLogFunction:function(az){if(A(this[az])){return}this[az]=function(){try{var aA=Array.prototype.slice.call(arguments);PopIn6.log(function(aC){var aE=M.Log.loggers[aC.type];var aD=aE[az];if(typeof aD==="function"){var aF=[aC].concat(aA);aD.apply(aE,aF);aC.execute()}})}catch(aB){console.error(aB)}}}};M.Log._addLogger("basic",{_addSegmentation:function(aC,aB){aB=aB||{};var aD=[];var aF=[];var aA=aC.data.length-1;while(aA>=0){if(aC.data[aA].indexOf("r5=")>-1){var az=aC.data.splice(aA,1);aF.push(az[0].split("=")[1])}aA-=1}aD.push(["ca",Z.category]);var aG=A(aB.common_category)?aB.common_category:Z.common_category;if(A(av.segmentData.abtest)){aD.push(["ab",av.segmentData.abtest])}if(A(aB.useCommonCategory)){aD.push(["cc",aG])}if(A(aB.onlyCommonCategory)){aD=[["cc",aG]]}if(A(aB.extra)){aD=aD.concat(aB.extra)}aD.forEach(function(aH){if(A(aH[1])){var aI=aH[0];var aJ=aH[1];aJ=Array.isArray(aJ)?aJ:[aJ];if(aI==="cc"){aJ=[aJ[0]]}aJ.forEach(function(aK){aF.push(aI+"_"+encodeURIComponent(aK))})}});var aE=Z.channel;if(aE){if("string"===typeof aE){aE=[aE]}if(Array.isArray(aE)){aE.forEach(function(aH){aF.push(aH)})}}aC.add("r5",aF.join("|"))},relatedLog:function(az){az.mode="other";var aA=/(jp|tw|kr|sg|th).popin.cc/.test(av.apiUrl)?"related-"+RegExp.$1:"related";az.add("type",aA);az.add("uid","");az.add("url",encodeURIComponent(av.target));az.uniqueId="related"},snsLog:function(az){az.valid=false;if(Math.random()<1/10){K("https://graph.facebook.com/?ids="+encodeURIComponent(av.target),function(aA){var aD=0;try{for(var aB in aA){aD+=aA[aB].share.share_count}}catch(aE){}if(aD>=30){az.valid=true}var aC=/(jp|tw|kr|sg|th).popin.cc/.test(av.apiUrl)?"share-"+RegExp.$1:"share-jp";az.add("url",encodeURIComponent(av.target));az.add("share",aD);az.add("type",aC);az.execute()})}},previewLog:function(az){az.add("url",encodeURIComponent(av.target));az.add("uid",PopIn6.uid);az.add("type",av.device+"_pv");az.add("nid",av.device);az.add("media",av.media);az.uniqueId="pv";this._addSegmentation(az)},boxInViewLog:function(az){az.add("url",encodeURIComponent(av.target));az.add("uid",PopIn6.uid);az.add("type",av.device+"_inview");az.add("nid",av.device);az.add("media",av.media);az.uniqueId="inview";this._addSegmentation(az)},articleClickLog:function(aA,aC,az,aB){aA.add("url","");aA.add("uid",PopIn6.uid);aA.add("type",av.device+"_rclick");aA.add("nid",av.device);aA.add("media",av.media);this._addSegmentation(aA,{extra:[["ch",aB.channelId]]});aA.onError=az;aA.onComplete=az},adBoxRenderedLog:function(az,aA){az.add("url",encodeURIComponent(av.target));az.add("uid",PopIn6.uid);az.add("type",av.device+"_imp");az.add("nid","");az.add("media",av.media);az.uniqueId="imp";this._addSegmentation(az,{onlyCommonCategory:true})},adInViewLog:function(aA,aB,az){if(aB.imp){aA.valid=false}az=az||{};az.common_category=A(az.common_category)?az.common_category:"";aA.trackingPixel=aB.trackingPixel;aA.add("url",encodeURIComponent(av.target));aA.add("uid",PopIn6.uid);aA.add("type",av.device+"_imp");aA.add("nid",aB.nid);aA.add("campaign",aB.campaign);aA.add("media",av.media);this._addSegmentation(aA,{onlyCommonCategory:true,common_category:az.common_category});aA.add("r6",aB.token);if(A(aB.trackingPixel)){t(aB.trackingPixel)}else{if(A(aB.tracking_pixel)){t(aB.tracking_pixel)}}},intextBoxRenderedLog:function(az,aA){az.add("url",encodeURIComponent(av.target));az.add("uid","");az.add("type",av.device+"_channel_pv");az.add("nid",av.device);az.add("media",av.media);this._addSegmentation(az,{extra:[["ch",aA.channelId]]})},intextBoxInViewLog:function(az,aA){az.add("url",encodeURIComponent(av.target));az.add("uid","");az.add("type",av.device+"_channel_inview");az.add("nid",av.device);az.add("media",av.media);this._addSegmentation(az,{extra:[["ch",aA.channelId]]})},intextBoxImpLog:function(az,aA){az.add("url",encodeURIComponent(av.target));az.add("uid","");az.add("type",av.device+"_channel_imp");az.add("nid","");az.add("media",av.media);this._addSegmentation(az,{extra:[["ch",aA.channelId]]})},videoLog:function(az,aB,aA){if(aA=="imp"){az.valid=false}az.add("url",encodeURIComponent(av.target));az.add("uid",PopIn6.uid);az.add("type",av.device+"_video_"+aA);az.add("nid",aB.video.nid);az.add("campaign",aB.video.campaign);az.add("media",av.media);az.add("r5","cc_video");if((""+aA)==="100"){this._addSegmentation(az,{useCommonCategory:true})}az.add("r6","video_imp")}});M.Log._addLogger("treasure",{_addSegmentation:function(aB,aA){aA=aA||{};var aC=A(aA.common_category)?aA.common_category:Z.common_category;if(A(aC)){aB.add("common_category",Array.isArray(aC)?aC[0]:aC)}aB.add("category",Z.category);if(A(av.segmentData.abtest)){aB.add("abtest",av.segmentData.abtest)}var az=A(aA.extra)?"m_"+aA.extra[0].join("_"):"";aB.add("extra",az)},_setCommon:function(az){az.add("api_host",av.apiHost);az.add("device",av.device);az.add("media",av.media);az.add("url",av.target);if(A(Z.logid)){az.add("logid",Z.logid)}if(A(Z.rid)){az.add("rid",Z.rid)}az.add("popin_user_id",W.getUid());var aB=az.getTrackValues();aB.td_title=Z.title||"";for(var aA in aB){az.add(aA,aB[aA])}az.add("client_id",aB.td_client_id);az._uainfo=ax},adRequestLog:function(az){var aB=av.apiUrl+"&"+av.apiUrlAdd;var aA=(aB.match(/[\?&]rid=([^&]+)/)||["",""])[1];var aC=(aB.match(/[\?&]alg=([^&]+)/)||["",""])[1];az.db="popin_ads";az.table="adlogs";az.add("type","req");az.add("rid",aA);az.add("alg",aC);az.add("time_show_seconds",Math.round((Date.now()-X)/1000));az.add("request_ad",av.ad);az.add("response_ad",Z.ad.length);az.add("smjad",(Z.ad_smj&&Z.ad_smj.length)>0?1:0);az.add("af",(Z.af)?Z.af+"":"");this._setCommon(az);this._addSegmentation(az)},adCriteoRequestLog:function(aA,az){aA.db="popin_ads";aA.table="adcriteo";aA.add("type","req");aA.add("time_show_seconds",Math.round((Date.now()-X)/1000));aA.add("request_ad",av.ad);aA.add("response_ad",Z.ad.length);this._setCommon(aA);this._addSegmentation(aA)},adInViewLog:function(aA,aC,az){az=az||{};az.common_category=A(az.common_category)?az.common_category:"";aA.db="popin_ads";aA.table="adlogs";aA.add("type",aC.reserved?"reserved_imp":"imp");aA.add("time_show_seconds",Math.round((Date.now()-X)/1000));aA.add("nid",aC.nid);aA.add("campaign",aC.campaign);aA.add("token",aC.token);aA.add("timestamp",Date.now());aA.add("recommend_position",aC.renderPosition);aA.add("ad_position",aC.adPosition);aA.add("channel_id",az.channelId);aA.add("is_feed_module",aC.isFeedModule);if(aC.c1){aA.add("c1",aC.c1)}if(aC.c2){aA.add("c2",aC.c2)}aA.add("title",aC.title||"");aA.add("sample",aC.sample||"");aA.add("v_fruit_word",aC.v_fruit_word||"");aA.add("image_hash",aC.image_hash||"");aA.add("classify",aC.classify||"");aA.add("image",aC.image||"");if(aC.clarity!=="undefined"){aA.add("clarity",aC.clarity)}if(aC.aesthetic!=="undefined"){aA.add("aesthetic",aC.aesthetic)}if(Z.sample_tag){aA.add("sample_tag",Z.sample_tag)}aA.add("smjad",aC.isSmjAd?1:0);this._setCommon(aA);this._addSegmentation(aA,{common_category:az.common_category});var aB=aw(aC.element);aA.add("fruit_style",aB.articleStyleMonitor&&aB.articleStyleMonitor.getStyleFlag());aA.add("box_style",aB.boxStyleMonitor&&aB.boxStyleMonitor.getStyleFlag());aA.add("referrer_recommend_type",aB.referrerRecommendType)},adCriteoInViewLog:function(aA,aB,az){az=az||{};az.common_category=A(az.common_category)?az.common_category:"";aA.db="popin_ads";aA.table="adcriteo";aA.add("type",aB.reserved?"reserved_imp":"imp");aA.add("time_show_seconds",Math.round((Date.now()-X)/1000));aA.add("nid",aB.nid);aA.add("campaign",aB.campaign);aA.add("token",aB.token);aA.add("timestamp",Date.now());if(aB.c1){aA.add("c1",aB.c1)}if(aB.c2){aA.add("c2",aB.c2)}if(Z.sample_tag){aA.add("sample_tag",Z.sample_tag)}this._setCommon(aA);this._addSegmentation(aA,{common_category:az.common_category})},adClickLog:function(aA,aB,az){aA.db="popin_ads";aA.table="adlogs";aA.add("type","click");aA.add("time_show_seconds",Math.round((Date.now()-X)/1000));aA.add("nid",aB.nid);aA.add("campaign",aB.campaign);aA.add("token",aB.token);aA.add("position",aB.renderPosition);aA.add("timestamp",Date.now());if(aB.c1){aA.add("c1",aB.c1)}if(aB.c2){aA.add("c2",aB.c2)}if(Z.sample_tag){aA.add("sample_tag",Z.sample_tag)}aA.add("smjad",aB.isSmjAd?1:0);this._setCommon(aA);this._addSegmentation(aA,{extra:[["ch",az.channelId]]})},adMediaDnaLog:function(az,aA){az.db="popin_media";az.table="mediadna_clicks";az.add("campaign_id",aA.campaign);az.add("timestamp",Date.now());this._setCommon(az)},concatenationPVLog:function(aA){var az=window._popIn_concatenation_param;aA.db="popin_media";aA.table="pageview_concatenation";aA.uniqueId="concatnation_pv";if(!A(az)){aA.valid=false}else{aA.add("user_id",az.user_id);aA.add("useragent_popin",az.useragent);if(location.href.indexOf("tabelog.com")>-1){aA.add("pv_time",az.pv_time);aA.add("pv_hostname",location.host)}aA.add("timestamp",Date.now())}},previewLog:function(az){az.db="popin_media";az.table="discoverylogs";az.uniqueId="pv";az.add("r_url","");az.add("type",0);this._setCommon(az);this._addSegmentation(az)},articleInViewLog:function(aB,aE,aA){aB.db="popin_media";aB.table="discoverylogs";aB.add("r_url",aE.url);aB.add("type",1);aB.add("recommend_type",aE.type);aB.add("recommend_position",aE.renderPosition);aB.add("channel_id",aA.channelId||"");aB.add("is_feed_module",aE.isFeedModule);if(aE.type==="cf"){if(aE.RecallRefer){var aD=aE.RecallRefer;if(Array.isArray(aD)){aD=aD.join("|")}aB.add("recall_refer",aD)}var az=Z.identity;if(typeof az==="object"){for(var aC in az){if(az.hasOwnProperty(aC)){aB.add(aC,az[aC])}}}}this._setCommon(aB);this._addSegmentation(aB)},articleClickLog:function(aB,aF,az,aE){aB.db="popin_media";aB.table="discoverylogs";aB.add("r_url",aF.url);aB.add("type",2);aB.add("recommend_type",aF.type);aB.add("recommend_position",aF.renderPosition);aB.add("is_feed_module",aF.isFeedModule);aB.add("channel_id",aE.channelId||"");if(aF.type==="cf"){if(aF.RecallRefer){var aD=aF.RecallRefer;if(Array.isArray(aD)){aD=aD.join("|")}aB.add("recall_refer",aD)}var aA=Z.identity;if(typeof aA==="object"){for(var aC in aA){if(aA.hasOwnProperty(aC)){aB.add(aC,aA[aC])}}}}this._setCommon(aB);this._addSegmentation(aB,{extra:[["ch",aE.channelId]]})},boxInViewLog:function(az,aA){az.db="popin_media";az.table="discoverylogs";az.add("r_url","");az.add("type",3);az.add("is_feed_module",aA.isFeedModule);az.uniqueId="inview";this._setCommon(az);this._addSegmentation(az)},adBoxRenderedLog:function(az,aA){az.db="popin_media";az.table="discoverylogs";az.add("r_url","");az.add("type",4);az.add("is_feed_module",aA.isFeedModule);az.uniqueId="imp";this._setCommon(az);this._addSegmentation(az)},boxInViewLogs:function(az,aA){az.db="popin_media";az.table="discoverylogs";az.add("r_url","");az.add("type",5);az.add("channel_id",aA.channelId);az.add("is_feed_module",aA.isFeedModule);az.add("box_position",aA.boxPosition);this._setCommon(az);this._addSegmentation(az)},adBoxRenderedLogs:function(az,aA){az.db="popin_media";az.table="discoverylogs";az.add("type",6);az.add("channel_id",aA.channelId);az.add("is_feed_module",aA.isFeedModule);az.uniqueId="imp";az.typeIndex=6;az.channelId=aA.channelId;this._setCommon(az);this._addSegmentation(az)},intextBoxRenderedLog:function(az,aA){az.db="popin_media";az.table="discoverylogs";az.add("type",7);az.add("is_feed_module",aA.isFeedModule||"");az.add("channel_id",aA.channelId||"");this._setCommon(az);this._addSegmentation(az)},videoLog:function(az,aB,aA){az.db="popin_ads";az.table="adlogs";az.add("api_host",av.apiHost);az.add("type","video_"+aA);az.add("time_show_seconds",Math.round((Date.now()-X)/1000));az.add("nid",aB.video.nid);az.add("campaign",aB.video.campaign);az.add("timestamp",Date.now())},videoMediaDnaLog:function(az,aB,aA){az.db="popin_media";az.table="mediadna_clicks";az.add("campaign_id",aB.video.campaign);az.add("timestamp",Date.now());this._setCommon(az)},checkSmjIdLog:function(az,aC,aA){az.db="popin_ads";az.table="smj_id";az.add("action","localStorage");az.add("key",PopIn6.smjId);var aB=window===top?location.host:(document.referrer.match(/^https?:\/\/([^\/]+)/)||[0,""])[1];az.add("host",aB)}});M.Log._addLogger("inrecsys",{_setCommon:function(az){var aB=az.getTrackValues();aB.td_title=Z.title||"";for(var aA in aB){az.add(aA,aB[aA])}var aD=Z.common_category;if(A(aD)){az.add("dish_common_category",Array.isArray(aD)?aD[0]:aD)}az.add("key","key"+X);az.add("now",Date.now());az.add("client_id",aB.td_client_id);az.add("url",av.target);az.add("popin_user_id",W.getUid());az.add("smjId",PopIn6.smjId||"");az.add("device",av.device);az.add("dish_media",av.media);az.add("dish_category",Z.category||"");az.add("dish_domain",location.host);az.add("td_ip",Z.ip||"");if(A(Z.logid)){az.add("logid",Z.logid)}az.add("api_host",av.apiHost);var aC=["td_browser","td_browser_version","td_os","td_os_version"];aC.forEach(function(aE){az.add(aE,ax[aE.replace(/td_/,"")])})},_setArticleData:function(aA,aE){aA.add("dish_td_title",Z.title||"");aA.add("dish_pubdate",Z.pubdate||"");aA.add("dish_td_url",encodeURIComponent(av.target));var aF=aE.originalUrl;var aD=aE.common_category||"";aA.add("fruit_common_category",Array.isArray(aD)?aD[0]:aD);aA.add("fruit_domain",ag(aF).host);aA.add("fruit_td_title",aE.title);aA.add("fruit_pubdate",aE.pubdate);aA.add("fruit_category",aE.category);aA.add("fruit_td_url",aE.pureUrl);aA.add("fruit_media",aE.media);aA.add("fruit_image",aE.image);aA.add("fruit_recommend_type",aE.type);aA.add("fruit_recommend_position",aE.renderPosition);if(aE.type==="cf"){if(aE.RecallRefer){var aC=aE.RecallRefer;if(Array.isArray(aC)){aC=aC.join("|")}aA.add("recall_refer",aC)}var az=Z.identity;if(typeof az==="object"){for(var aB in az){if(az.hasOwnProperty(aB)){aA.add(aB,az[aB])}}}}},previewLog:function(az){az.api="other";az.uniqueId="pv";this._setCommon(az);az.add("domain",location.host)},adInViewLog:function(aA,aE,az){if(aE.reserved){aA.valid=false}aA.api="ad";this._setCommon(aA);aA.add("type","imp");aA.add("time_show_seconds",Math.round((Date.now()-X)/1000));aA.add("nid",aE.nid);aA.add("token",aE.token);aA.add("timestamp",X);aA.add("box_position",az.boxPosition||"");aA.add("channel_id",az.channelId);if(aE.c1){aA.add("c1",aE.c1)}if(aE.c2){aA.add("c2",aE.c2)}if(Z.sample_tag){aA.add("sample_tag",Z.sample_tag)}aA.add("fruit_userid",aE.userid||"");aA.add("fruit_campaign",aE.campaign||"");aA.add("fruit_title",aE.title||"");aA.add("fruit_domain",aE.domain||"");aA.add("fruit_business_type",aE.business_type||"");aA.add("v_fruit_word",aE.v_fruit_word||"");aA.add("image_hash",aE.image_hash);aA.add("v_dish_labels",Z.v_dish_labels||"");aA.add("v_dish_tlabels",Z.v_dish_tlabels);aA.add("ad_position",aE.adPosition);aA.add("sample",aE.sample||"");aA.add("classify",aE.classify||"");aA.add("image",aE.image||"");if(typeof aE.clarity!=="undefined"){aA.add("clarity",aE.clarity||"")}if(typeof aE.aesthetic!=="undefined"){aA.add("aesthetic",aE.aesthetic||"")}var aD=["smjId","client_id","c1","popin_version","td_global_id","td_version","td_charset","td_language","td_path"];for(var aB=0;aB<aD.length;aB++){delete aA.data[aD[aB]]}var aC=aw(aE.element);aA.add("fruit_style",aC.articleStyleMonitor&&aC.articleStyleMonitor.getStyleFlag());aA.add("box_style",aC.boxStyleMonitor&&aC.boxStyleMonitor.getStyleFlag())},articleClickLog:function(aA,aC,az,aB){aA.api="discovery";this._setCommon(aA);aA.add("type","click");this._setArticleData(aA,aC)},articleInViewLog:function(az,aA){this.articleCounter=!A(this.articleCounter)?1:this.articleCounter+1;if(this.articleCounter>(p.inrecsysMaxArticleImpLog||3)){az.valid=false}az.api="discovery";this._setCommon(az);az.add("type","imp");this._setArticleData(az,aA)}});M.Performance={isSupported:(window.performance)&&(typeof window.performance.getEntries==="function")&&(typeof window.performance.now==="function"),enableMonitor:true,sample:0.1,isResourceReady:false,db:"fe_performance",table:"base_monitor",id:+(new Date),marks:{},data:{},resourceFilterRules:[function(az,aA){if(/popin.cc\/searchbox\/.+\.js$/.test(aA.name)){az.addMark("request_config_start",aA.startTime);az.set("rcd",parseInt(aA.duration,10));az.addMark("request_config_end",aA.responseEnd);return true}},function(az,aA){if(aA.name.indexOf(av.apiUrl)===0){az.addMark("request_api_start",aA.startTime);az.set("rad",parseInt(aA.duration,10));az.addMark("request_api_end",aA.responseEnd);return true}}],init:function(){if(!this.isSupported){return}var az=av;if(typeof az.performanceSample==="number"){this.sample=az.performanceSample}if(typeof az.enablePerformanceMonitor!=="undefined"){this.enableMonitor=az.enablePerformanceMonitor}if(R!==0||Math.random()>this.sample){this.enableMonitor=false}this.addMark("discovery_init",PopIn6.__PERFORMANCE_DISCOVERY_INIT__);if(this.enableMonitor){this.bindEvent()}return this},bindEvent:function(){var az=this;window.addEventListener("load",function(){az.isResourceReady=true;if(az.marks.is_box_rendered){az.report()}},false)},moniteBoxInview:function(){try{var aB=this;var az=[];av.templates.forEach(function(aD){var aC=aD.selector;if(az.indexOf(aC)===-1){i(aC,function(){if(!aB.marks.box_in_view){aB.addTimeMark("box_in_view").report()}});az.push(aC)}})}catch(aA){}},addTimeMark:function(az){if(!this.isSupported){return this}if(az==="box_did_render"&&this.marks.box_did_render!==void 0){return this}this.marks[az]=window.performance.now();return this},addMark:function(az,aA){this.marks[az]=aA;return this},set:function(az,aA){this.data[az]=aA;return this},collectResourceInfo:function(){var az=window.performance.getEntries();var aG=this.resourceFilterRules;var aE=aG.length;var aA={};for(var aC=0,aD;aD=az[aC++];){for(var aB=0,aF;aF=aG[aB];aB++){if(!aF(this,aD)){continue}aA[aF.key]=aD;aG.splice(aB,1);aE--;break}if(aE===0){break}}},analyse:function(){var az=this.data;var aA=G();az.host=aA.host;az.user_agent=aA.user_agent;az.browser=aA.browser;az.browser_version=aA.browser_version;az.os=aA.os;az.os_version=aA.os_version;az.device=Q();az.screen=aA.screen;az.api_host=av.apiHost;az.media=av.media;az.libLoadMode="inline";az.rcs=parseInt(this.marks.request_config_start,10);az.di_awr=this.calculate("discovery_init","api_will_request");az.awr_ras=this.calculate("api_will_request","request_api_start");az.rae_adwd=this.calculate("request_api_end","api_data_will_deal");az.adwd_bdr=this.calculate("api_data_will_deal","box_did_render");az.total=this.calculate("request_config_start","box_did_render");az.popin_version=6;az.performance_id=this.id},calculate:function(aB,aA){var az=this.marks;if(typeof az[aB]==="undefined"||typeof az[aA]==="undefined"){return"null"}return parseInt(az[aA]-az[aB],10)},report:function(){if(!this.enableMonitor||!this.isResourceReady||!this.marks.is_box_rendered||this.isReported){return}this.collectResourceInfo();this.analyse();if(this.data.total>0){this.log(this.data)}this.isReported=true;return this},log:function(aC,aB,az){az=az||this.db;aB=aB||this.table;var aA=new window.Treasure2({writeKey:"8378/25839e06ce4cc1cab55c1c1f1e49d336d6d1d48f",database:az});aA.addRecord(aB,aC);return this}};(function(){var az="_popIn_box_position_style_key_";M.Class("PositionAndStyle",{init:function(aA){this.positionAndStyleObj=aA||{};this.channelId=this.positionAndStyleObj.channelId;this.boxPosition=this.positionAndStyleObj.boxPosition||{};this.articleStyleMonitor=this.positionAndStyleObj.articleStyleMonitor||{};this.position="";this.styleMonitor="";this.timer=null;this.timerTimes=0;this.intervalPositionAndStyle()},intervalPositionAndStyle:function(){this.timer=setTimeout(this.setPositionAndStyle.bind(this),500)},setPositionAndStyle:function(){this.timerTimes++;var aB=[];this.position=this.boxPosition.getPosition();this.styleMonitor=this.articleStyleMonitor.getStyleFlag();if(this.position&&this.styleMonitor){if(window.popInPositionAndStyle){var aA=ah.valid?ah.local.get(az):"[]";aA=JSON.parse(aA);aA.push({channelId:this.channelId,boxPosition:this.position,adStyleMonitor:this.styleMonitor});aB=aA}else{aB=[{channelId:this.channelId,boxPosition:this.position,adStyleMonitor:this.styleMonitor}];window.popInPositionAndStyle=true}ah.valid&&ah.local.set(az,JSON.stringify(aB));clearTimeout(this.timer)}else{this.timerTimes<10?this.intervalPositionAndStyle():clearTimeout(this.timer)}}},{getPositionAndStyle:function(){var aA="";var aC="";var aB=ah.valid?ah.local.get(az):"";if(aB){aB=JSON.parse(aB);if(aB&&aB.length>0){aA=aB[0].boxPosition||"";aC=aB[0].adStyleMonitor||""}}return{boxPosition:aA,adStyleMonitor:aC}}})})();M.Class("Template",{init:function(aA){this.setDefaults();for(var az in aA){this[az]=aA[az]}this.selectorStr=this.selector;this.selector=document.querySelector(this.selectorStr);this.isFullClick=this.plugins.some(function(aB){return aB.toLowerCase().indexOf("clickall")>-1||aB.toLowerCase().indexOf("fullclick")>-1})},setDefaults:function(){this.notFoundImg=window.PopIn6.protocol+"//"+ae+"/images/noimg.png";this.imageInView=true;this.adVideoPosition=1;this.adVideoInsertSelector=false;this.adVideoInsertPosition="BeforeEnd";this.addTargetBlank=false;this.isTargetTop=false;this.plugins=[];this.isFullClick=false;this.canInfiniteAds=true;this.includeRules=[];this.excludeRules=[];this.dateFormat="Y.M.D";this.isClickHistory=true;this.hideHistory=false;this.articleNoDisplayPeriod=7;this.aboutPageType=(Q()==="mobile")?"newTab":"dialogue"}});(function(){var aF="";var aE="";var aJ="__pi_u_id__";var aK=/^([\d\w]{32})|(\d{13})-\d+$/;var aB="https://api.popin.cc";var aQ=aB+"/iframe/piuid.html?ac=piuid&t=15888888";var aI=null;var aG=false;M.Class("UserId",{init:function(){try{if("function"===typeof window.postMessage&&!/.+_sdk$/.test(p.pid)){aP()}aE=aC(aJ)||"";var aT=aC("_ss_pp_id")||"";if(aK.test(aE)){aF=aE.split("-")[0];return}else{aA(aJ)}if(/^([\da-f]{32})|(\d{13})$/.test(aT)){aF=aT;aE=aT+"-"+az();aR(aJ,aE);aG=true;return}else{aA("_ss_pp_id")}PopIn6.event.addEventListener("result-loaded",function(aU){var aV=aU.cookie;if(aV&&aV.uid&&(!aF||aG)){aF=aV.uid;aE=aF+"-"+az();aR(aJ,aE);aG=true}})}catch(aS){aO(aS)}},getUid:function(){if(!aF){aL()}return aF}});function aR(aS,aU){try{localStorage.setItem(aS,aU);return true}catch(aT){return false}}function aC(aS){try{return localStorage.getItem(aS)}catch(aT){return""}}function aA(aS){try{return localStorage.removeItem(aS)}catch(aT){return""}}function aP(){aI=E(aQ);function aS(aT){try{if(aI.window!==aT.source){return}var aU=JSON.parse(aT.data);if(aU.action==="get"){aN(aU.payload)}else{if(aU.action==="done"){window.removeEventListener("message",aS);aI.parentNode&&aI.parentNode.removeChild(aI);aI=null}}}catch(aV){aO(aV)}}window.addEventListener("message",aS,false)}function aD(aS){if(!aK.test(aS)){return}aI.window.postMessage(JSON.stringify({action:"setId",payload:aS}),aB)}function aN(aU){if("string"!==typeof aU||!aK.test(aU)){aD(aE);return}if(!aF||aG){aE=aU;aF=aU.split("-")[0];aR(aJ,aU);aG=false;return}if(aU===aE){return}var aT=aU.split("-");var aS=aE.split("-");if(aS[1]>=aT[1]){aF=aT[0];aR(aJ,aU);if(aT[0]!==aS[0]&&aC(aJ)===aU){aH({previous_id:aS[0],previous_create_time:aS[1],current_id:aT[0],current_create_time:aT[1],host:top.location.host})}return}aD(aE)}function aM(aS){var aT=parseInt(Math.floor(Math.random()*Math.pow(16,aS))).toString(16);return(""+Math.pow(10,aS)+aT).slice(-aS)}function aL(){aF=[aM(8),aM(4),aM(4),aM(4),aM(12)].join("");aE=aF+"-"+az();aR(aJ,aE);aG=true;return aE}function az(){var aS=new Date;aS.setMinutes(aS.getMinutes()+aS.getTimezoneOffset());return aS.getTime()}function aH(aS){if(window.Treasure2){(new window.Treasure2({writeKey:"8378/25839e06ce4cc1cab55c1c1f1e49d336d6d1d48f",database:"popin_user_id"})).addRecord("uid_change_log",aS)}else{setTimeout(function(){aH(aS)},1000)}}function aO(aS){if(window.Treasure2){(new window.Treasure2({writeKey:"8378/25839e06ce4cc1cab55c1c1f1e49d336d6d1d48f",database:"fe_monitor"})).addRecord("err_log",{msg:aS.message||"",stack:aS.stack||"",name:aS.name||"",ua:navigator.userAgent})}else{setTimeout(function(){aO(aS)},1000)}}})();M.Class("Video",{init:function(az,aA){this.container=az;this.template=aA;this.logs={};if(typeof _popIn_noVideo_loader==="function"){PopIn6.event.addEventListener("no-video",_popIn_noVideo_loader)}if(!ah.valid){return}if(Q()!=="mobile"){return}var aB=this.getVideo();if(A(aB)){this.renderVideo(aB)}},getVideo:function(){var aF=[];if(A(av.adVideo)&&A(Z.ad_video)){aF=aF.concat(Z.ad_video)}if(A(av.adReservedVideo)&&A(Z.ad_reserved_video)){aF=aF.concat(Z.ad_reserved_video)}if(aF.length===0){PopIn6.event.fireEvent("no-video",[])}var aE=ah.session.get("_video")||"";aE=aE.split(".");var aD=[];for(var aC=0;aC<aF.length;aC++){var aB=aF[aC];var aA=0;for(var az=0;az<aE.length;az++){if(aE[az]===aB.nid){aA++}}if(aA>1){continue}aD.push(aB)}return aD.length>0?aD[0]:false},createContainer:function(){var az=false;if(typeof window._popIn_video6!=="undefined"){return false}if(A(this.template.adVideoInsertSelector)){az=document.body.querySelectorAll(this.template.adVideoInsertSelector)}else{az=this.container.querySelectorAll("._popIn_infinite_page")}if(az.length>0&&this.template.adVideoPosition-1<az.length){return az[this.template.adVideoPosition-1]}return false},renderVideo:function(aB){var aA=this.createContainer();if(!A(aA)){return}var az=aa(document.createDocumentFragment(),"div","_popIn_infinite_video");var aF=this.template.adVideoInsertPosition.toLowerCase();if(aF==="beforebegin"){aA.parentNode.insertBefore(az,aA)}if(aF==="afterbegin"){aA.insertBefore(az,aA.firstChild)}if(aF==="beforeend"){aA.appendChild(az)}if(aF==="afterend"){aA.parentNode.insertBefore(az,aA.nextSibling)}var aH=ag(av.apiUrl);var aI=[["discoveryplus.popin.cc","jp"],["jp.popin.cc","jp"],["tw.popin.cc","tw"],["kr.popin.cc","kr"],["popin.cc","jp"]];var aE="jp";for(var aG=0,aD=aI.length;aG<aD;aG++){var aC=aI[aG];if(aH.host.indexOf(aC[0])>-1){aE=aC[1];break}}window._popIn_video6={container:az,data:aB,logger:this,country:aE};var aJ=document.createElement("script");aJ.type="text/javascript";aJ.charset="UTF-8";aJ.async=true;aJ.src=window.PopIn6.protocol+"//"+ae+"/popin_video6_ads-min.js";var aK=document.getElementsByTagName("script")[0];aK.parentNode.insertBefore(aJ,aK);return},log:function(aC){var aK=aC.type;var aF=aK+(A(aC.value)?"_"+aC.value:"");if(!A(this.logs[aF])){this.logs[aF]=1}else{this.logs[aF]++}var aA=this.logs[aF];aC.counter=aA;var aH=aC.video;var aM=(A(aH.type)&&aH.type==="vast")?true:false;if(aK==="second"&&aA>1){return}if(aK==="percent"&&aA>1){return}if(aK==="inview"&&aH.tracking_pixel&&aA===1){t(aH.tracking_pixel)}var aL=A(aH.video.background)||(A(aH.video.type)&&aH.video.type==="vertical");var aE=av.apiHost;function az(aN){aN.forEach(function(aO){aG(aO,true)})}function aG(aN,aO){new Image().src=aN+(A(aO)?"":"&t="+Date.now())}function aD(aN){M.Log.videoLog(aC,aN)}if(aF==="full"&&aM&&A(aH.ClickTracking)&&aA===1){az(aH.ClickTracking)}if(aF==="second_1"){}if(A(aH.video.play_time_seconds)&&aF==="second_"+aH.video.play_time_seconds){var aJ=aH.url;aJ+=((aJ.indexOf("?")>0?"&":"?")+"type="+(aL?"vertical_":"")+"imp&api_host="+aE);aG(aJ+"&target=c");if(aM&&A(aH.Impression)){az(aH.Impression)}aD("playTimeSeconds")}if(aF==="percent_100"){var aI=aH.url;aI+=((aI.indexOf("?")>0?"&":"?")+"type=end&api_host="+aE);aG(aI);if(aM&&A(aH.complete)){az(aH.complete)}}if(aF==="second_2"){this.saveHistory(aC);var aB=aH.url;aB+=((aB.indexOf("?")>0?"&":"?")+"type="+(aL?"vertical_":"")+"imp&api_host="+aE);aG(aB+(A(aH.video.play_time_seconds)?"&target=m":""));aD("imp");M.Log.videoMediaDnaLog(aC,aK);if(aM&&A(aH.start)){az(aH.start)}return aD("2s")}if(aF==="second_3"){return aD("3s")}if(aK==="percent"){if(aC.value%25===0||aC.value===95){if(aM){switch(aC.value){case 25:az(aH.firstQuartile);break;case 50:az(aH.midpoint);break;case 75:az(aH.thirdQuartile);break;default:break}}return aD(""+aC.value)}}if(aK==="share"){return aD("share_"+aC.value)}if(!A(aC.value)){return aD(aK)}},saveHistory:function(aA){var az=ah.session.get("_video");if(A(az)){az+=("."+aA.video.nid)}else{az=aA.video.nid}ah.session.set("_video",az)}});var R=0;R+=(location.href.indexOf("popintest=true")>-1?1:0);R+=(location.href.indexOf("popinadtest=true")>-1?1:0);R+=(location.href.indexOf("popinadid=")>-1?1:0);R+=(location.href.indexOf("popinadimage=")>-1?1:0);R+=(location.href.indexOf("popinvideotest=")>-1?1:0);I._testMode=R;var Y="__smjidfa__";if(ah.valid){PopIn6.smjId=ah.local.get(Y)}var X=Date.now();var W=new M.UserId();var av=new M.Config();var Z={};I._selectedArticles=an;I._userId=W;I._config=av;I._start=X;window.PopIn=window.PopIn||{};window.PopIn.init=function(az){az=az||{};W=new M.UserId();an=[];av=new M.Config(az);Z={};X=Date.now();new M.Loader()};var F="";if(ah.valid){F=ah.local.get("_ss_pp_id")||""}var S=function(){var aD=[["news.google.co","portal_google"],["search.yahoo.co","search_yahoo"],["facebook.co","sns_facebook"],["twitter.co","sns_twitter"],["t.co$","sns_twitter"],["yahoo.co","portal_yahoo"],["goo.ne","portal_goo"],["infoseek.co","portal_infoseek"],["msn.com","portal_msn"],["excite.co.jp","portal_excite"],["livedoor.com","portal_livedoor"],["search.naver.com","search_naver"],["naver.com|naver.jp","sns_naver"],["hatena.ne.jp","sns_hatena"],["aol.jp","portal_aol"],["google.co","search_google"],["www.bing.com","search_bing"],["www.biglobe.ne.jp","portal_biglobe"],["www.smartnews.be|www.smartnews.com","app_smartnews"],["gunosy.com","app_gunosy"],["newspicks.com","app_newspicks"],["antenna.jp","app_antenna"],["paid.outbrain.com","paid_outbrain"],["trc.taboola.com","paid_yahoo"],["dsp.logly.co.jp","paid_logly"]];aD.push([location.host,"site"]);var aB="other";var aC=ag(document.referrer).host;for(var aA=0,aE=aD.length;aA<aE;aA++){var az=aD[aA];if(RegExp(az[0]).test(aC)){aB=az[1];break}}if(document.referrer===""){aB="organic"}if(location.href.indexOf("utm_medium=logly")>-1){aB="paid_logly"}return aB};var B=S();M.Performance.init();PopIn6.event.fireEvent("after-init",[]);new M.Loader()}catch(au){window.PopIn6.handleError(au)}})();var y=function(){var s=0;var i=false;var A=function(C){s++;i=C};window.addEventListener("touchstart",A,false);window.addEventListener("click",A,false);window.addEventListener("mousedown",A,false);var t={};function z(C){if(C.valid===false){return false}if(C.uniqueId){var D=C.type+"|"+C.uniqueId;if(C.type==="treasure"&&C.typeIndex===6&&C.uniqueId==="imp"){D=C.type+"|"+C.uniqueId+"|"+C.channelId}if(t[D]){return false}t[D]=1}return true}var B={};B.Class=function(D,C){this[D]=function(){if(this.init){this.init.apply(this,arguments)}};C.type=D.toLowerCase();this[D].prototype=C};B.Class("Basic",{init:function(){this.data=[];this.mode="normal"},add:function(C,D){this.data.push(C+"="+D)},imageLog:function(D){var C=new Image();if(this.onComplete){C.onload=this.onComplete}if(this.onError){C.onerror=this.onError}C.src=D},execute:function(){this.add("t",Date.now());var C=window.PopIn6.protocol;if(z(this)){switch(this.mode){case"normal":this.imageLog(C+"//rlog.popin.cc/s.gif?"+this.data.join("&"));break;case"other":this.imageLog(C+"//r.popin.cc/log.gif?"+this.data.join("&"));break}}}});B.Class("Treasure",{init:function(){this.data={}},add:function(C,D){this.data[C]=D},imageLog:function(D){var C=new Image();if(this.onComplete){C.onload=this.onComplete}if(this.onError){C.onerror=this.onError}C.src=D},getTrackValues:function(){return PopIn6._logger.trackValues||{}},execute:function(){this.data.interaction_number=s;if(i){if(i.touches){var D=i.touches[0];this.data.interaction_touchx=Math.round(D.pageX);this.data.interaction_touchy=Math.round(D.pageY)}if(i.type==="mousedown"){this.data.interaction_mousex=Math.round(i.pageX);this.data.interaction_mousey=Math.round(i.pageY)}}var C=this;this.add("popin_version",6);if(z(this)){if(this.db==="popin_media"&&this.table==="discoverylogs"){this.sendToUts();return this}this.sendToTd();if(this.db==="popin_ads"&&this.table==="adlogs"){this.sendToUts()}return this}},sendToTd:function(){var D=new Treasure2({writeKey:"8378/25839e06ce4cc1cab55c1c1f1e49d336d6d1d48f",database:this.db});D.set("$global","td_global_id","td_global_id");var C=this;D.addRecord(this.table,this.data,function(){if(C.onComplete){C.onComplete()}},function(){if(C.onError){C.onError()}})},sendToUts:function(){var C=this._uainfo;this.data.td_os=C.os;this.data.td_os_version=C.os_version;this.data.td_browser=C.browser;this.data.td_browser_version=C.browser_version;delete this.data.td_ip;var D=JSON.stringify(this.data);this.imageLog([window.PopIn6.protocol+"//log.popin.cc/log","/"+this.db,"/"+this.table,"?data="+btoa(unescape(encodeURIComponent(D)))].join(""))}});B.Class("Inrecsys",{init:function(){this.data={}},getTrackValues:function(){return PopIn6._logger.trackValues||{}},add:function(C,D){this.data[C]=D},imageLog:function(D){var C=new Image();if(this.onComplete){C.onload=this.onComplete}if(this.onError){C.onerror=this.onError}C.src=D},execute:function(){this.add("popin_version",6);var C=JSON.stringify(this.data);var D=btoa(unescape(encodeURIComponent(C)));if(z(this)){this.imageLog(window.PopIn6.protocol+"//inrecsys.popin.cc/PopinService/Logs/"+this.api+"?data="+D)}}});PopIn6.log=function(C){C(new B.Basic());C(new B.Treasure());C(new B.Inrecsys())};if(PopIn6._tempLog){while(PopIn6._tempLog.length>0){PopIn6.log(PopIn6._tempLog.shift())}}};y();var w=function(t){var s=[];s.push("all-test");var A=PopIn5.$F.isMobileDevice()?"mobile":"pc";if(location.href.indexOf("popintest=true")>0){s.push(A+"-test")}s.push(A);s.push("all");for(var z=0;z<s.length;z++){var B=s[z];if(PopIn5.$F.notEmpty(e[B])&&PopIn5.$F.notEmpty(e[B][t])){return e[B][t]}}return false};if(typeof _popIn5_config["*"]==="undefined"){_popIn5_config["*"]=p}if(typeof _popIn5_config.Discovery==="undefined"){_popIn5_config.Discovery=function(){return false}}if(typeof _popIn5_config.Read==="undefined"){_popIn5_config.Read=function(){return w("Read")}}var d=false;var c=document.getElementsByTagName("script");for(var v=0,b=c.length;v<b;v++){var u=c[v];if(u.src.indexOf("popin_discovery5-min.js")>-1){d=true}}if(!d){var a=document.createElement("script"),r=window.PopIn6;a.type="text/javascript";a.charset="utf-8";a.async=true;a.src=r.protocol+"//"+r.domain+"/popin_discovery5-min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n)}return}var w=function(t){var s=[];s.push("all-test");var A=PopIn5.$F.isMobileDevice()?"mobile":"pc";if(location.href.indexOf("popintest=true")>0){s.push(A+"-test")}s.push(A);s.push("all");for(var z=0;z<s.length;z++){var B=s[z];if(PopIn5.$F.notEmpty(e[B])&&PopIn5.$F.notEmpty(e[B][t])){return e[B][t]}}return false};if(typeof _popIn5_config["*"]==="undefined"){_popIn5_config["*"]=p}if(typeof _popIn5_config.Discovery==="undefined"){_popIn5_config.Discovery=function(){return w("Discovery")}}if(typeof _popIn5_config.Read==="undefined"){_popIn5_config.Read=function(){return w("Read")}}var a=document.createElement("script");a.type="text/javascript";a.charset="utf-8";a.async=true;a.src=window.location.protocol+"//api.popin.cc/popin_discovery5-min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n)})();